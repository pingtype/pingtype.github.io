<!--
	TurtleSheet
	Peter Burkimsher 2016-10-27
	
	Railway:
		Limited Express data to confirm stations in red
	
	To Do:
		Object-oriented design. Every time the pen is picked up and put down, a new object is created.
		Saving multiple "files" into LocalStorage.
		Compile subroutines in Logo code (to cube ...end).
		Draggable turtle, objects.
		Onclick scripts.
		Animation, save gif.
		Multiple turtles.
		Setsh to change the turtle icon.
		Line colour, width.
		Fill area.
		Object awareness - don't draw a label over something else.
		Diagonal selection in spreadsheet.
		Jump turtle to new coordinates.
-->

<!DOCTYPE html>
<html>
<head>
	<title>TurtleSheet</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link rel="stylesheet" href="leaflet/leaflet.css" />
	<!--[if lte IE 8]><link rel="stylesheet" href="leaflet.ie.css" /><![endif]-->

	<style>

		body {
		font-family: Helvetica;
		}

		li {
			list-style: none;
		}
		li:before {
			content: "✓ ";
		}

		input {
			border: none;
			width: 80px;
			font-size: 14px;
			padding: 2px;
		}

		input:hover {
			background-color: #eee;
		}

		input:focus {
			background-color: #ccf;
		}

		input:not(:focus) {
			text-align: right;
		}

		table {
			border-collapse: collapse;  
		}

		td {
			border: 1px solid #999;
			padding: 0;
		}

		tr:first-child td, td:first-child {
			background-color: #ccc;
			padding: 1px 3px;
			font-weight: bold;
			text-align: center;
		}

		footer {
			font-size: 80%;
		}

	</style>
	<style>
		.labelClass{
			white-space:nowrap;
			text-align:center;
			border-radius:0%;
			color: black
		}
		
		.leaflet-container {
    		background-color:rgba(255,0,0,0.0);
		}
	</style>
</head>
<body>
	
	<!-- External scripts -->
	<script src="leaflet/leaflet.js"></script>
	<!--<script src="leaflet051.js"></script>-->
	
	<!-- Rotated marker from https://github.com/bbecquet/Leaflet.RotatedMarker-->
	<script src="leaflet.rotatedMarker.js"></script> 

	<!-- Semicircle from https://github.com/jieter/Leaflet-semicircle -->
	<script src="Semicircle.js"></script> 

	<!-- Leaflet to PNG-->
	<script src="leaflet-image.js"></script> 
		
	<!-- Actual HTML layout -->

	
	<h2>
		TurtleSheet
	</h2>
	
	Peter Burkimsher 2016-10-28
	<br>
		• Lost? See the <a href="readMe.html">Read Me</a>
	</br>
	
	<p>
	</p>
	
	
	<table>
		<tr>
			<td style="background-color:#FFFFFF;border: none;text-align: left;">
				Import Area
			</td>
			<td style="background-color:#FFFFFF;border: none;text-align: left;">
				Spreadsheet
			</td>
			<td style="background-color:#FFFFFF;border: none;text-align: left;">
				Drawing
			</td>
		</tr>
		<tr>
			<td style="background-color:#FFFFFF;border: none;">
				<textarea id="importArea" rows="34" cols="10"></textarea>
			</td>
			<td style="background-color:#FFFFFF;border: none;">
				<div style="overflow-y: scroll; height:450px; overflow-x: scroll; width:510px;">
					<table id="spreadsheet" style=""></table>
				</div>
			</td>
			<td style="background-color:#FFFFFF;">
				<div id="drawing" style="width: 640px; height: 480px; float: right;"></div>
			</td>
			<td style="background-color:#FFFFFF;border: none;">
				<div id="images"></div>
			</td>
			<td style="background-color:#FFFFFF;border: none;">
				<table id="objects" style="display:none"></table>
			</td>
		</tr>
	</table>
	
	<table>
		<tr>
			<td style="width:100px;height:20px;background-color:#44C4C4;text-align:center;"
			onclick="importSheet();">
				Import
			</td>
			<td style="width:100px;height:20px;background-color:#44C4C4;text-align:center;display:none"
			onclick="leafletImage(drawing, doImage);">
				Export
			</td>
		</tr>

	</table>
	
	<table>
		<tr>
			<td style="width:100px;height:20px;background-color:#44C4C4;text-align:center;"
			onclick="clearSpreadsheet();">
				Clear
			</td>
		</tr>
		<tr>
		<td style="display:none">
			<input id="numberRowsField"></input>
		</td>
			<td style="width:100px;height:20px;background-color:#44C4C4;text-align:center;display:none"
			onclick="setRows();">
				Rows
			</td>
		</tr>
		<td style="display:none">
			<input id="numberColumnsField"></input>
		</td>
			<td style="width:100px;height:20px;background-color:#44C4C4;text-align:center;display:none"
			onclick="setColumns();">
				Columns
			</td>
		</tr>
	</table>

	<br></br>

	<table>
		<tr>
			<td style="background-color:#FFFFFF;border: none;text-align: left;">
				Logo Code
			</td>
			<td style="background-color:#FFFFFF;border: none;text-align: left;">
				
			</td>
			<td style="background-color:#FFFFFF;border: none;text-align: left;">
				JavaScript code
			</td>
		</tr>
		<tr>
			<td style="background-color: #FFFFFF;border: 0px solid #FFFFFF;">
				<textarea id="logoCodeArea" rows="10" cols="40"></textarea>
			</td>
			<td style="background-color: #FFFFFF;border: 0px solid #FFFFFF;">
				<table>
					<tr>
						<td style="background-color: #FFFFFF;border: 0px solid #FFFFFF;" onclick="compile(logoCodeArea.value, '');">
							<img src="images/SECompileScriptImage.png">
						</td>
						<td style="border: none;background-color: #FFFFFF; font-weight: normal;" onclick="compile(logoCodeArea.value, '');">
							Compile
						</td>
					</tr>
					<tr>
						<td style="background-color: #FFFFFF;border: 0px solid #FFFFFF;" onclick="load();" onclick="load();">
							<img src="images/SEBundleContentsClosedImage.png">
						</td>
						<td style="border: none;">
							Load
						</td>
					</tr>
					<tr>
						<td style="background-color: #FFFFFF;border: 0px solid #FFFFFF;" onclick="save();" onclick="save();">
							<img src="images/floppy_disk.png">
						</td>
						<td style="border: none;">
							Save
						</td>
					</tr>
				</table>
			</td>
			<td style="background-color: #FFFFFF;border: 0px solid #FFFFFF;">
				<textarea id="jsCodeArea" rows="10" cols="40"></textarea>
			</td>
			<td style="background-color: #FFFFFF;border: 0px solid #FFFFFF;" onclick="run();">
				<img src="images/SERunScriptImage.png">
			</td>
			<td style="border: none;" onclick="run();">
				Run
			</td>
		</tr>
	</table>
	
	<table>
		<tr>
			<td style="background-color:#FFFFFF;border: none;text-align: left;">
				Shortcuts
			</td>
		</tr>
		<tr>
			<td style="width:100px;height:20px;background-color:#44C4C4;text-align:center;"
			onclick="lt(90);">
				lt 90
			</td>
			<td style="width:100px;height:20px;background-color:#44C4C4;text-align:center;"
			onclick="fd(50);">
				fd 50
			</td>
			<td style="width:100px;height:20px;background-color:#44C4C4;text-align:center;"
			onclick="rt(90);">
				rt 90
			</td>
		</tr>
		<tr>
			<td style="width:100px;height:20px;background-color:#44C4C4;text-align:center;"
			onclick="cg();">
				cg
			</td>
			<td style="width:100px;height:20px;background-color:#44C4C4;text-align:center;"
			onclick="square();">
				square
			</td>
			<td style="width:100px;height:20px;background-color:#44C4C4;text-align:center;"
			onclick="genealogy();">
				genealogy
			</td>
		</tr>
	</table>


	<!-- Setup scripts -->

	<script>
	
		function globalVariables()
		{
			var drawing;
			var turtle;
			var penIsUp;
			var lineArray;
			var currentLineArray;
			var allLinesArrays;
			var currentLineObject;
			var drawingObjects;
			var numberObjects;
			var objectTable;
			var objectNames;
			var objectLatitudes;
			var objectLongitudes;
			var objectAngles;

		} // end function globalVariables
	
		// addObject - Add a new object to the list on the right
		function addObject(objectType, objectName)
		{
			// Add the objects to the object table
			objectTable = document.getElementById("objects");

			// Create an empty <tr> element and add it to the last position of the table
			//numberObjects = drawingObjects.length;
			objectRow = objectTable.insertRow(numberObjects);

			// Insert new cells (<td> elements) into the last row
			objectCell = objectRow.insertCell(0);
			objectCell.innerHTML = objectType;
			objectCell = objectRow.insertCell(1);
			objectCell.innerHTML = objectName;
			
			// Save the object name in an array
			objectNames.push(objectName);
			
			var thisLatitude = turtle.getLatLng().lat;
			var thisLongitude = turtle.getLatLng().lng;
			var thisAngle = turtle.options.rotationAngle;
			
			objectLatitudes.push(thisLatitude);
			objectLongitudes.push(thisLongitude);
			objectAngles.push(thisAngle);
			
			numberObjects = numberObjects + 1;
			
		} // end function addObject

		// pd - Pen down. Start a new line. 
		function pd() 
		{
			penIsUp = false;
			
			// Reset the line array
			lineArray = new Array();
			var turtleLatitude = turtle.getLatLng().lat;
			var turtleLongitude = turtle.getLatLng().lng;
			var turtleLatLng = new L.LatLng(turtleLatitude, turtleLongitude);			

			lineArray.push(turtleLatLng);

			// Support multiple lines
			currentLineArray = currentLineArray + 1;
			allLinesArrays.push(lineArray);

			currentLineObject = numberObjects - 1;
			lineObject = new L.polyline(allLinesArrays[currentLineArray], {color: 'black',weight: 1,opacity: 1,smoothFactor: 1});
    	
			drawing.addLayer(lineObject);
		
		
			// The lines and labels are all in one array of drawing objects
			drawingObjects.push(lineObject);
			
			// Add the line to the list on the right
			addObject("Line", "Untitled");
			
			
		} // end function pd
		
		// dashedLine - Start drawing a dashed line. 
		function dashedLine() 
		{
			penIsUp = false;
			
			// Reset the line array
			lineArray = new Array();
			var turtleLatitude = turtle.getLatLng().lat;
			var turtleLongitude = turtle.getLatLng().lng;
			var turtleLatLng = new L.LatLng(turtleLatitude, turtleLongitude);			

			lineArray.push(turtleLatLng);

			// Support multiple lines
			currentLineArray = currentLineArray + 1;
			allLinesArrays.push(lineArray);

			currentLineObject = numberObjects - 1;
			lineObject = new L.polyline(allLinesArrays[currentLineArray], {color: '#d9701f',weight: 1,opacity: 1,dashArray: '10,10',smoothFactor: 1});
    	
			drawing.addLayer(lineObject);
		
		
			// The lines and labels are all in one array of drawing objects
			drawingObjects.push(lineObject);
			
			// Add the line to the list on the right
			addObject("DashedLine", "Untitled");
			
			
		} // end function dashedLine		

	
		// Leaflet drawing area
		function initialiseLeaflet()
		{

			var zoomLevel = 10;
			
			drawing = new L.Map("drawing",{
				center: [0, 0],
				zoom: zoomLevel,
				zoomControl:true,
				crs: L.CRS.Simple
			});

			drawing.setZoom(2);


			drawing.attributionControl.setPrefix(''); // Don't show the 'Powered by Leaflet' text.

			// The turtle
								
			var TurtleIcon = L.Icon.extend({
				options: {
					iconSize:     [32, 32],
					iconAnchor:   [16, 20],
					popupAnchor:  [0, 0]
				}
			});
		
			var thisTurtleIcon = new TurtleIcon({iconUrl: 'images/turtle.png'});

			turtle = L.marker([0,0], {icon: thisTurtleIcon,rotationOrigin: '16px 20px', rotationAngle: 0, opacity: 1}).addTo(drawing);

			// Whether the pen is up or down
			penIsUp = false;

			// The line
			lineArray = new Array();
		
			//lineArray.push([0, 0]);

			// Support multiple lines
			currentLineArray = 0;
			allLinesArrays = new Array();
			allLinesArrays.push(lineArray);

			currentLineObject = 0;
			var lineObject = new L.polyline(allLinesArrays[currentLineArray], {color: 'black',weight: 1,opacity: 1,smoothFactor: 1});
		
			drawing.addLayer(lineObject);
				
			// The lines and labels are all in one array of drawing objects
			drawingObjects = new Array();
				
			drawingObjects.push(lineObject);
		
			numberObjects = 1;
		
			// Add the objects to the object table
			objectTable = document.getElementById("objects");

			// Insert new cells (<td> elements) into the last row
			var objectRow = objectTable.insertRow(0);
			var objectCell = objectRow.insertCell(0);
			objectCell.innerHTML = "Object";
			objectCell = objectRow.insertCell(1);
			objectCell.innerHTML = "Name";
		
			objectNames = new Array();
			objectLatitudes = new Array();
			objectLongitudes = new Array();
			objectAngles = new Array();

			objectLatitudes.push("0");
			objectLongitudes.push("0");
			objectAngles.push("0");

			pd();
		} // end function initialiseLeaflet

		// resizeDrawing - Re-initialise Leaflet with a new map size
		function resizeDrawing(newWidth, newHeight)
		{
			// Resize the drawing area
			var drawingArea = document.getElementById("drawing");
			drawingArea.style.width = newWidth;
			drawingArea.style.height = newHeight;
			
			drawing.remove();
			
			initialiseLeaflet();

		} // end function resizeDrawing

		
		// Run the initialiseLeaflet function first
		globalVariables();
		initialiseLeaflet();
		
	</script>
	

	<script>
		// Spreadsheet from http://jsfiddle.net/ondras/hYfN3/
		
		var localStorageColumns = localStorage["numberColumns"];
		var localStorageRows = localStorage["numberRows"];
		
		if (localStorageColumns == null)
		{
			var numberColumns = 5;
		} else {
			var numberColumns = localStorageColumns;
		}
		
		if (localStorageRows == null)
		{
			var numberRows = 10;
		} else {
			var numberRows = localStorageRows;
		}
		
		buildSpreadsheet(numberColumns, numberRows);
		
		function buildSpreadsheet(numberColumns, numberRows)
		{
			// Erase a previous spreadsheet
			document.getElementById("spreadsheet").innerHTML = "";
			
			// Write the number of rows and columns to the interface
			document.getElementById("numberRowsField").value = numberRows;
			document.getElementById("numberColumnsField").value = numberColumns;
			
			// For every row, build the spreadsheet one column at a time
			for (var currentRow = 0; currentRow <= numberRows; currentRow++) 
			{
				var row = document.getElementById("spreadsheet").insertRow(-1);
			
				for (var currentColumn=0; currentColumn <= numberColumns; currentColumn++) 
				{
					var columnName = String.fromCharCode("A".charCodeAt(0)+currentColumn-1);
					row.insertCell(-1).innerHTML = currentRow&&currentColumn ? "<input id='"+ columnName+currentRow +"'/>" : currentRow||columnName;
				}
			} // end for building the spreadsheet

			var DATA={};
			var INPUTS=[].slice.call(document.getElementById("spreadsheet").querySelectorAll("input"));
		
			INPUTS.forEach(
				function(elm) {
					elm.onfocus = function(e) 
					{
						e.target.value = localStorage[e.target.id] || "";
					};
		   
					elm.onblur = function(e) 
					{
						localStorage[e.target.id] = e.target.value;
						computeAll();
					};
		   
					var getter = function() 
					{
						var value = localStorage[elm.id] || "";
						if (value.charAt(0) == "=") 
						{
							with (DATA) return eval(value.substring(1));
						} else { 
							return isNaN(parseFloat(value)) ? value : parseFloat(value); 
						}
					};
		   
					Object.defineProperty(DATA, elm.id, {get:getter});
					Object.defineProperty(DATA, elm.id.toLowerCase(), {get:getter});
		   
				} // end function elm
			);
			(
				window.computeAll = function() 
				{
					INPUTS.forEach(
					function(elm) 
					{ 
						try 
						{ 
							elm.value = DATA[elm.id]; 
						} catch(e) 
						{
							// Don't do anything if no data is found
						} 
					});
				}
			)();
		} // end function buildSpreadsheet
		
		function textBetween(thisText, startString, endString)
		{
			var start_pos = 0;
			if (startString != 'start')
			{
				start_pos = thisText.indexOf(startString);
						
				// If the text does not contain the start string, return a blank string
				if (start_pos < 0)
				{
					return '';
				}
						
				// Skip the first startString characters
				start_pos = start_pos + startString.length;
			}
					
					
			var end_pos = thisText.length;
			if (endString != 'end')
			{
				end_pos = thisText.indexOf(endString,start_pos);
			}
					
			// If the text does not have the end string after the start string, return the whole string after the start
			if (end_pos < start_pos)
			{
				end_pos = thisText.length;
			}
					
			var newText = thisText.substring(start_pos,end_pos);
					
			return newText;
		} // end textBetween
		
		// contains - Does thisText contain searchString?
		function contains(thisText, searchString)
		{
			if (thisText == null)
			{
				return false;
			}
			
			return thisText.indexOf(searchString) != -1;
		} // end function contains
		
	</script>
	
	
	<!-- Interface event scripts -->
	<script>
	
		// importSheet - Read tab-delimited text from importArea and put it into the spreadsheet
		function importSheet()
		{
			// Read the text
			var importText = importArea.value;
			
			importText=importText.split(/\r?\n/);
			
			var numberRows = importText.length;
			
			for (var currentRow = 1; currentRow <= numberRows; currentRow++) 
			{
			
				var thisRow = importText[currentRow-1];
				
				thisRow = thisRow.split(/\t/);
				
				var numberColumns = thisRow.length;
							
				for (var currentColumn=1; currentColumn <= numberColumns; currentColumn++) 
				{
					var thisCell = thisRow[currentColumn-1];
					
					
					var columnName = String.fromCharCode("A".charCodeAt(0)+currentColumn-1);

					localStorage[columnName+currentRow] = thisCell;
				} // end for every column on this row
			
			} // end for every row
			
			// Reload the spreadsheet
			computeAll();
			
		} // end function importSheet
		
		// importCsv - Parse comma-delimited data into the spreadsheet
		function importCsv(importText)
		{
			importText=importText.split(/,/);
		
			var numberRows = importText.length;
			
			for (var currentRow = 1; currentRow <= numberRows; currentRow++) 
			{
			
				var thisRow = importText[currentRow-1];
				
				thisRow = thisRow.split(/\t/);
				
				var numberColumns = thisRow.length;
							
				for (var currentColumn=1; currentColumn <= numberColumns; currentColumn++) 
				{
					var thisCell = thisRow[currentColumn-1];
					
					
					var columnName = String.fromCharCode("A".charCodeAt(0)+currentColumn-1);

					localStorage[columnName+currentRow] = thisCell;
				} // end for every column on this row
			
			} // end for every row
			
			// Reload the spreadsheet
			computeAll();
			
		} // end function importCsv
	
		// Clear the spreadsheet
		function clearSpreadsheet()
		{
			for (var currentRow = 0; currentRow <= numberRows; currentRow++) 
			{
				var row = document.getElementById("spreadsheet").insertRow(-1);
			
				for (var currentColumn=0; currentColumn <= numberColumns; currentColumn++) 
				{
					var columnName = String.fromCharCode("A".charCodeAt(0)+currentColumn-1);
					
					localStorage[columnName+currentRow] = "";
				}
			} // end for building the spreadsheet
			
			computeAll();
		} // end function clearSpreadsheet
		
		// Set the number of rows in the spreadsheet
		function setRows()
		{
			// Read the value from the interface
			var newNumberRows = document.getElementById("numberRowsField").value;
			
			// If there is a new number of rows entered
			if (newNumberRows != "")
			{
				numberRows = newNumberRows;
			}
			
			// Save the new value to local storage
			localStorage["numberRows"] = numberRows;
			
			// Rebuild the spreadsheet
			buildSpreadsheet(numberColumns, numberRows);
		} // end function setRows

		// Set the number of rows in the spreadsheet
		function setColumns()
		{
			// Read the value from the interface
			var newNumberColumns = document.getElementById("numberColumnsField").value;
			
			// If there is a new number of rows entered
			if (newNumberColumns != "")
			{
				numberColumns = newNumberColumns;
			}
			
			// Save the new value to local storage
			localStorage["numberColumns"] = numberColumns;
			
			// Rebuild the spreadsheet
			buildSpreadsheet(numberColumns, numberRows);
		} // end function setRows

		// doImage - Read a PNG onto a canvas
		function doImage(err, canvas) 
		{
				
			var img = document.createElement('img');
			var dimensions = drawing.getSize();
			img.width = dimensions.x;
			img.height = dimensions.y;
			img.src = canvas.toDataURL();
			document.getElementById('images').innerHTML = '';
			document.getElementById('images').appendChild(img);
		} // end function doImage		
		
		// Compile Logo code to JavaScript
		function compile(logoCode, indent)
		{			
			logoCode=logoCode.split(/\r?\n/);
			
			var numberLines = logoCode.length;
			
			// For every line in the code
			for (var currentLine = 0; currentLine < numberLines; currentLine++) 
			{
				// Get the line
				var thisLine = logoCode[currentLine];
				
				// Split the command and the data
				var thisCommand = textBetween(thisLine, "start", " ");
				var thisData = textBetween(thisLine, " ", "end");
				
				// If this line contains square brackets, compile it differently
				if (contains(thisData, "["))
				{				
					// If this is a repeat loop
					if (contains(thisCommand,"repeat"))
					{
						compileRepeat(thisData);
					} // end if repeat
					
					// If this is a label command
					if (contains(thisCommand,"label"))
					{					
						thisData = textBetween(thisData, "[", "]");
						
						jsLine = indent + thisCommand + "(\"" + thisData + "\");\n";
						appendJsCode(jsLine);
					
					} // end if label
					
				} else {
				
					// Build the JavaScript line
					var jsLine = indent;
					jsLine = jsLine + thisCommand;
					jsLine = jsLine + "(";
					
					// If this data is not blank
					if (thisData != "")
					{
						jsLine = jsLine + "\"";
						jsLine = jsLine + thisData;
						jsLine = jsLine + "\"";
					} // end if thisData is not blank
					
					jsLine = jsLine + ")";
					jsLine = jsLine + ";";
					jsLine = jsLine + "\n";
				
					// Append the line to the JavaScript code
					appendJsCode(jsLine);
				}  // end if this line contains square brackets
				
			} // end for every line
						
		} // end function compile
		
		
		// compileRepeat - make a loop and execute it
		function compileRepeat(parameters)
		{
			var numberTimes = textBetween(parameters, "start", " ");
			
			var jsLine;
			
			jsLine = "var numberTimes = " + numberTimes + ";\n";
			appendJsCode(jsLine);

			jsLine = "for (currentTime = 0; currentTime < numberTimes; currentTime++)\n";
			appendJsCode(jsLine);

			jsLine = "{\n";
			appendJsCode(jsLine);

			var subCode = textBetween(parameters, "[", "]");
			subCode=subCode.split(/ /);

			var numberCommands = subCode.length;
			
			// For every command in the repeat loop
			for (currentCommand = 0; currentCommand < numberCommands; currentCommand = currentCommand + 2)
			{
				var thisCommand = subCode[currentCommand];
				var thisData = subCode[currentCommand+1];
				
				compile(thisCommand + " " + thisData, "	");
				
			} // end for every command

			jsLine = "}\n";
			appendJsCode(jsLine);
			
		} // end function compileRepeat
		
		// load - Load Logo Code from the localStorage
		function load()
		{
			var logoCode = localStorage["logoCode"];
			
			document.getElementById("logoCodeArea").value = logoCode;
		} // end function load
		
		// save - Save Logo Code to the localStorage
		function save()
		{
			var logoCode = document.getElementById("logoCodeArea").value;
						
			localStorage["logoCode"] = logoCode;
		} // end function save
		
		// Append code to the JS text area
		function appendJsCode(thisLine)
		{
			var jsCode = jsCodeArea.value;
			jsCode = jsCode + thisLine;
			jsCodeArea.value = jsCode;
		} // end appendJsCode
		
		// Run the JavaScript in the editor
		function run() 
		{
    		return eval(jsCodeArea.value);
		} // end function run

		// Check if a value is a number
		function isNumeric(n) 
		{
			return !isNaN(parseFloat(n)) && isFinite(n);
		} // end function isNumeric

		// Calculate the sin of a number of degrees
		function sinDegrees(angle) 
		{
			return Math.sin(angle/180*Math.PI);
		} // end function sinDegrees

		// Calculate the cos of a number of degrees
		function cosDegrees(angle) 
		{
			return Math.cos(angle/180*Math.PI);
		} // end function cosDegrees

		// Repeat - make a loop and execute it
		function repeat(numberTimes, thisCode)
		{
			// For number of times to do the loop
			for (currentTime = 0; currentTime < numberTimes; currentTime++)
			{
    			eval(thisCode);
			} // end for number of times
		} // end function repeat
		


	</script>

	<!-- LogoWriter features -->
	<script>

		// rt - synonym for right
		function rt(degrees) { right(degrees); }

		// Turn right
		function right(degrees)
		{
			var oldAngle = turtle.options.rotationAngle;
						
			// If it's not a number, it's probably a cell, so try to read it from local storage
			if (isNumeric(degrees) == false)
			{			
				degrees = localStorage[degrees];
			} else {
				// If it is numeric, multiply it by 1 just to make sure. This caused problems with quoted integers before. 
				degrees = degrees * 1;
			} // end if not numeric
			
			var newAngle = oldAngle + degrees;
			
			if (newAngle >= 360)
			{
				newAngle = newAngle - 360;
			}
			
			if (newAngle < 0)
			{
				newAngle = newAngle + 360;
			}
			turtle.setRotationAngle(newAngle);
			
		} // end function right

		// Turn left
		function left(degrees)
		{
			degrees = degrees * -1;
			right(degrees);
		} // end function left

		// lt - synonym for left
		function lt(degrees) { left(degrees); }
		
		// Go forward
		// To do: teach the turtle how to calculate geometry for non-right angles
		function forward(steps)
		{
			var oldLatitude = turtle.getLatLng().lat;
			var oldLongitude = turtle.getLatLng().lng;
			
			var angle = turtle.options.rotationAngle;
			
			var newLatitude = oldLatitude;
			var newLongitude = oldLongitude;
						
			// If it's not a number, it's probably a cell, so try to read it from local storage
			if (isNumeric(steps) == false)
			{			
				steps = localStorage[steps];
			} else {
				// If it is numeric, multiply it by 1 just to make sure. This caused problems with quoted integers before. 
				steps = steps * 1;
			} // end if not numeric
			
			// Right angles are easy, and using a switch statement is good for educational purposes
			switch (angle)
			{
				case 0:
					newLatitude = newLatitude + steps; break;
				case 90:
					newLongitude = newLongitude + steps; break;
				case 180:
					newLatitude = newLatitude - steps; break;
				case 270:
					newLongitude = newLongitude - steps; break;
				default:
					// Calculate geometry. sohcahtoa!
					var hypotenuse = steps;
										
					var opposite = sinDegrees(angle) * hypotenuse;
					var adjacent = cosDegrees(angle) * hypotenuse;
					
					newLongitude = newLongitude + opposite;
					newLatitude = newLatitude + adjacent;

					break;
			} // end switch right angles
			
			// Move the turtle
			var newLatLng = new L.LatLng(newLatitude, newLongitude);			
			turtle.setLatLng(newLatLng);
			
			// If the pen is down, add the new point to the current line
			if (penIsUp == false)
			{
				// Draw the line
				allLinesArrays[currentLineArray].push([newLatitude, newLongitude]);
				drawingObjects[currentLineObject].addLatLng([newLatitude, newLongitude]);
			
    			drawingObjects[currentLineObject].redraw();
    		} // end if pen is up
    		
		} // end function forward
		
		// fd - synonym for forward
		function fd(degrees) { forward(degrees); }
		
		// back - move the turtle back
		function back(steps)
		{
			// Run forward with a negative number
			forward(-1 * steps);
		} // end function bk


		// bk - synonym for back
		function bk(steps) { back(steps); }

		// ht - Hide the turtle
		function ht() 
		{ 
			turtle.setOpacity(0);
		} // end function ht

		// st - Show the turtle
		function st() 
		{ 
			turtle.setOpacity(1);
		} // end function st

		// cg - Clear graphics
		function cg() 
		{
			// Move the turtle back to the centre and make it visible
			var newLatLng = new L.LatLng(0, 0);
			turtle.setLatLng(newLatLng);
			turtle.setRotationAngle(0);
			turtle.setOpacity(1);
			
			// Remove all markers
			for(currentLayer in drawingObjects) 
			{
				try 
            	{
            		drawing.removeLayer(drawingObjects[currentLayer]);
           		} catch(e) {
               		alert("problem with " + e + drawing._layers[i]);
           		} // end try to remove layer
    		} // end for every layer
			
			// Reset the line array
			lineArray = new Array();
			lineArray.push([0, 0]);

			// Support multiple lines
			currentLineArray = 0;
			allLinesArrays = new Array();
			allLinesArrays.push(lineArray);

			currentLineObject = 0;
			lineObject = new L.polyline(allLinesArrays[currentLineArray], {color: 'black',weight: 1,opacity: 0.5,smoothFactor: 1});
    	
			drawing.addLayer(lineObject);
		
		
			// The lines and labels are all in one array of drawing objects
			drawingObjects = new Array();
		
			drawingObjects.push(lineObject);
    		
		} // end function cg

		// pu - Pen up. Stop adding points to the current line. 
		function pu() 
		{
			penIsUp = true;
						
		} // end function pu	

		// Circle
		function circle(circleColour)
		{
			var coordinates = turtle.getLatLng();
			var radius = 1;
			
			if (circleColour == null)
			{
				circleColour = "#FFFFFF";
			}
			
			var circleObject = new L.circle(coordinates, radius, {color: "#000000", fillColor:circleColour, fillOpacity: 1, weight: 1});
			
			drawing.addLayer(circleObject);
			
			addObject("Circle", "Untitled");
			
			// Add the label to drawing objects, so it can be cleared
			drawingObjects.push(circleObject);
			
			return circleObject;
		} // end function circle

		// semicircle
		function semicircle(circleColour, thisStartAngle, thisStopAngle)
		{
			var coordinates = turtle.getLatLng();
			var radius = 1;
			
			if (circleColour == null)
			{
				circleColour = "#FFFFFF";
			}
			
			var circleObject = new L.circle(coordinates, radius, {color: "#000000", fillColor:circleColour, fillOpacity: 1, weight: 1, startAngle: thisStartAngle, stopAngle: thisStopAngle});
			
			drawing.addLayer(circleObject);
			
			addObject("Semicircle", "Untitled");
			
			// Add the label to drawing objects, so it can be cleared
			drawingObjects.push(circleObject);

		} // end function semicircle

		// function halfCircleTop - A shortcut for a semicircle
		function halfCircleTop(circleColour)
		{
			semicircle(circleColour, -90, 90);
		} // end function halfCircleTop

		// function halfCircleBottom - A shortcut for a semicircle
		function halfCircleBottom(circleColour)
		{
			semicircle(circleColour, 90, 270);
		} // end function halfCircleBottom

		// function thirdCircleRight - A shortcut for a semicircle
		function thirdCircleRight(circleColour)
		{
			semicircle(circleColour, 0, 120);
		} // end function thirdCircleRight

		// function thirdCircleBottom - A shortcut for a semicircle
		function thirdCircleBottom(circleColour)
		{
			semicircle(circleColour, 120, 240);
		} // end function thirdCircleBottom

		// function thirdCircleLeft - A shortcut for a semicircle
		function thirdCircleLeft(circleColour)
		{
			semicircle(circleColour, 240, 360);
		} // end function thirdCircleLeft


		// createLabelIcon
		function createLabelIcon(labelText)
		{
			return L.divIcon(
			{
				className: "labelClass",
				html: labelText
			});
		} // end function createLabelIcon

		// label - Add a text label at the current position
		function labelOffset(thisText, offset)
		{
		
			var markerLatLng = turtle.getLatLng();
			
			var turtleLatitude = markerLatLng.lat;
			var turtleLongitude = markerLatLng.lng;
			
			var angle = turtle.options.rotationAngle;
			
			var markerLatitude = turtleLatitude;
			var markerLongitude = turtleLongitude;
			
			var markerLatLng = new L.LatLng(markerLatitude, markerLongitude);
			
			var labelRotation=0;
			var textAlign = "left";
			
			// Right angles are easy, and using a switch statement is good for educational purposes
			switch (angle)
			{
				case 0:
					labelRotation=0;
					textAlign = "left";
					break;
				case 90:
					labelRotation=90;
					textAlign = "top";
					break;
				case 180:
					//labelRotation=180;
					
					// Reading text upside down is hard
					labelRotation=0;
					textAlign = "right";
					break;
				case 270:
					labelRotation=270;
					textAlign = "bottom";
					break;
				default:
					labelRotation=angle;
					textAlign = "left";
					break;
			} // end switch right angles
				
			
			var labelHtml = "<div id='thisLabel' style='transform: rotate("+labelRotation+"deg); -webkit-transform: rotate("+labelRotation+"deg);float:"+textAlign+"; '>" + thisText + "</div>";

			// Add the label first, then move it based on the width.
			var thisLabel = L.marker(markerLatLng, {icon:createLabelIcon(labelHtml)});
			
			// Add the label to drawing objects, so it can be cleared
			drawingObjects.push(thisLabel);
			
			// Add the label to the drawing
			thisLabel.addTo(drawing);
			
			addObject("Label",thisText);
			
			var test = document.getElementById("thisLabel");
			var labelWidth = test.clientWidth;
			var labelHeight = test.clientHeight;
        	var turtleWidth = 8;
        	
        	// Set the id to something unique, like the label text
        	test.setAttribute("id", thisText);
						
			// Right angles are easy, and using a switch statement is good for educational purposes
			
			switch (angle)
			{
				case 0:
					//markerLatitude = markerLatitude + offset;
					markerLongitude = markerLongitude + offset;
					break;
				case 90:
					markerLatitude = markerLatitude - offset;
					//markerLongitude = markerLongitude + offset;
					break;
				case 180:
					//markerLatitude = markerLatitude - offset;
					markerLongitude = markerLongitude - offset;
					break;
				case 270:
					markerLatitude = markerLatitude + offset;
					//markerLatitude = markerLatitude + (offset * 1.5);
					//markerLongitude = markerLongitude - offset;
					break;
				default:
					// Calculate geometry. sohcahtoa!
					var hypotenuse = offset;
										
					var opposite = sinDegrees(angle) * hypotenuse;
					var adjacent = cosDegrees(angle) * hypotenuse;
					
					markerLongitude = markerLongitude + opposite;
					markerLatitude = markerLatitude + adjacent;

					break;
			} // end switch right angles
			
			
			// Move the label						
			markerLatLng = new L.LatLng(markerLatitude, markerLongitude);
			
			thisLabel.setLatLng(markerLatLng);
			
			
			
			//var thisCircle = L.circleMarker(markerLatLng, { fillColor: "#FFFFFF", radius: 6 } ).bindLabel("hello world", { noHide: true, opacity: 0.7, direction: 'right', offset: [-280, -32] }).addTo(drawing);
		} // end function label
		
		function label(thisText)
		{
			labelOffset(thisText, 3);
		} // end function labelOffset

		// jump - Move the turtle to new coordinates without drawing a line
		function jump(newLatitude, newLongitude)
		{
			// Lift the pen up
			pu();
			
			// Move the turtle
			var newLatLng = new L.LatLng(newLatitude, newLongitude);			
			turtle.setLatLng(newLatLng);
			
			// Put the pen down
			pd();
		} // end function jump

		// jumpName - Move the turtle to the coordinates of a named object
		function jumpName(searchName)
		{
			for (var currentObject = 0; currentObject < numberObjects; currentObject++)
			{
				var thisName = objectNames[currentObject];
				
				if (thisName == searchName)
				{
					var thisLatitude = objectLatitudes[currentObject];
					var thisLongitude = objectLongitudes[currentObject];
					var thisAngle = objectAngles[currentObject];
					
					turtle.options.rotationAngle = thisAngle;
					
					jump(thisLatitude, thisLongitude);
					
					break;
				} // end if this is the right name
				
			} // end search for the right object
		} // end function jumpName


		// Initialise with a cg
		cg();

	</script>
	
	
	<!-- Drawings. These should normally be user-generated, but here are some examples. -->
	<script>
		// square
		function square()
		{

			for (currentSide = 0; currentSide < 4; currentSide++)
			{
				fd(50);
				rt(90);
			} // end for each side
		
		} // end function square

		// cube - from the original!
		function cube()
		{
			square();
			fd(50);
			rt(45);
			fd(25);
			rt(45);
			fd(50);
			rt(180);
			lt(45);
			fd(25);
			lt(45);
			fd(50);
			rt(180);
			rt(45);
			fd(25);
			lt(45);
			fd(50);
		} // end function cube
				
		// Taiwan railway
		function railway()
		{
				
			importArea.value = "label(\"Badu 八堵\");halfCircleTop(\"#d91820\");halfCircleBottom(\"#000000\");\nlt(90);\nfd(3);\nlabel(\"Sankeng 三坑\");\ncircle();\nfd(5);\nlabel(\"Keelung 基隆\");circle(\"#d91820\");\nbk(8);\nrt(90);\n4\nlabel(\"Qidu 七堵\");circle(\"#d91820\");\n4\nBaifu 百福\n4\nWudu 五堵\n3\nlabel(\"Xizhi 汐止\");circle(\"#d91820\");\n2\ncircle();fd(1);label(\"Xike 汐科\");fd(5);\nlabel(\"Nangang 南港 <font color='#da5530'>HSR 高鐵</font> <font color='#1896dc'>MRT 捷運</font>\");thirdCircleRight(\"#f9bd93\");thirdCircleBottom(\"#1896dc\");thirdCircleLeft(\"#d91820\");\n5\nlabel(\"Songshan 松山 <font color='#1896dc'>MRT 捷運</font>\");halfCircleTop(\"#1896dc\");halfCircleBottom(\"#d91820\");\nfd(7);\nlabel(\"<b>Taipei 臺北</b> <font color='#da5530'>HSR 高鐵</font> <font color='#1896dc'>MRT 捷運</font>\");\nfd(1);\nthirdCircleRight(\"#f9bd93\");thirdCircleBottom(\"#1896dc\");thirdCircleLeft(\"#d91820\");\nfd(3);\nlabel(\"<font color='#1896dc'>(Longshan Temple MRT 龍山寺站捷運)</font>\");\nfd(2);\nhalfCircleTop(\"#1896dc\");halfCircleBottom(\"#d91820\");\nfd(1);\nlabel(\"Wanhua 萬華\");\nfd(5);\nlabel(\"Banqiao 板橋 <font color='#da5530'>HSR 高鐵</font> <font color='#1896dc'>MRT 捷運</font>\");thirdCircleRight(\"#f9bd93\");thirdCircleBottom(\"#1896dc\");thirdCircleLeft(\"#d91820\");\n3\nFuzhou 浮洲\n20\nlabel(\"Shulin 樹林\");circle(\"#d91820\");\n4\nSouth Shulin 南樹林\n4\nShanjia 山佳\n5\nlabel(\"Yingge 鶯歌\");circle(\"#d91820\");\n10\nlt(90);\npu();\ndashedLine();\nfd(10);\nlt(90);\nfd(9);\nrt(90);\nfd(10);\nrt(90);\nfd(20);\ncircle(\"#f9bd93\");\npu();\nbk(20);\nlt(90);\nbk(10);\nlt(90);\nbk(9);\nrt(90);\nbk(10);\npd();\nrt(90);\nlabel(\"Taoyuan 桃園\");circle(\"#d91820\");\n6\nNeili 內壢\n5\nlt(90);\npu();\ndashedLine();\nfd(20);\nlt(180);\ncircle(\"#f9bd93\");\npu();\nbk(2);\npd();\nlabel(\"<font color='#da5530'>Taoyuan HSR 桃園高鐵</font>\");\npu();\nfd(2);\nrt(180);\nbk(20);\nrt(90);\npd();\nlabel(\"Zhonglì 中壢\");circle(\"#d91820\");\n6\nPuxin 埔心\nfd(2);\nlt(90);\nfd(3);\nlabel(\"Yangmei 楊梅\");circle(\"#d91820\");\n6\nFugang 富岡\n5\nBaihwu 北湖\n4\nlabel(\"Hukou 湖口\");circle(\"#d91820\");\n6\nlabel(\"Xinfeng 新豐\");circle(\"#d91820\");\n6\nlabel(\"Zhubei 竹北\");circle(\"#d91820\");\n5\nlabel(\"North Hsinchu 北新竹\");circle(\"#000000\");\nlt(90);\nfd(4);label(\"Qianjia 千甲\");circle();\nfd(4);label(\"Xinzhuang 新莊\");circle();\nfd(3);label(\"Zhuzhong 竹中\");circle(\"#000000\");\nlt(90);\nfd(5);\npu();\ndashedLine();\nfd(4);\nlt(90);\nfd(5);\nlt(90);\nfd(7);\nrt(90);\nfd(2);\nrt(90);\nfd(3);\nlt(90);\nfd(4);\npu();\nbk(4);\nrt(90);\nbk(3);\nlt(90);\nbk(2);\nlt(90);\nbk(7);\nrt(90);\nbk(5);\nrt(90);\nbk(4);\npd();\nlabel(\"Liujia 六家 <font color='#da5530'>(Hsinchu HSR 新竹高鐵)</font>\");circle(\"#f9bd93\");\nbk(5);\nrt(90);\nfd(4);label(\"Shangyuan 上員\");circle();\nfd(6);label(\"Ronghua 榮華\");circle();\nfd(4);label(\"Zhudong 竹東\");circle();\nfd(5);label(\"Hengshan 橫山\");circle();\nfd(4);label(\"Jiuzantou 九讚頭\");circle();\nfd(4);label(\"Hexing 合興\");circle();\nfd(3);label(\"Fugui 富貴\");circle();\nfd(5);label(\"Neiwan 內灣\");circle();\nbk(46);\nrt(90);\n4\nlabel(\"<b>Hsinchu 新竹</b>\");circle(\"#d91820\");\n4\nSanxingqiao 三姓橋\n4\nXiangshan 香山\n6\nQiding 崎頂\n6\nlabel(\"Zhunan 竹南\");halfCircleTop(\"#d91820\");halfCircleBottom(\"#000000\");\nlt(90);\nfd(6);label(\"Tanwen 談文\");circle();\nfd(3);rt(90);fd(6);\nbk(6);\nlt(90);\nbk(9);\nrt(90);\n5\nZaoqiao 造橋\n5\nlt(90);\npu();\ndashedLine();\nfd(4);\nrt(90);\nfd(5);\nrt(90);\nfd(4);\npu();\nbk(4);\nlt(90);\nbk(5);\nlt(90);\nbk(4);\nrt(90);\npd();\nlabel(\"<font color='#da5530'>(Miaoli HSR 苗栗高鐵)</font> Fengfu 豐富\");circle(\"#f9bd93\");\n5\nlabel(\"Miaoli 苗栗\");circle(\"#d91820\");\n7\nNanshi 南勢\n5\nTongluo 銅鑼\n7\nSanyi 三義\n8\nTaian 泰安\n4\nlabel(\"Houli 后里\");circle(\"#d91820\");\n8\nlabel(\"Fengyuan 豐原\");circle(\"#d91820\");\n6\nTanzi 潭子\n5\nTaiyuan 太原\nfd(4);label(\"<b>Taichung 臺中</b>\");fd(1);circle(\"#d91820\");\nfd(3);label(\"Daqing 大慶\");fd(1);circle();\nfd(2);label(\"Wuri 烏日\");fd(1);circle();\n2\nlabel(\"<font color='#da5530'>(Taichung HSR 台中高鐵)</font> Xinwuri 新烏日\");halfCircleTop(\"#f9bd93\");halfCircleBottom(\"#d91820\");\n4\nlabel(\"Chenggong 成功\");circle(\"#000000\");\nlt(90);\nfd(4);label(\"Zhuifen 追分\");circle();\nfd(5);lt(90);fd(2);label(\"Dadu 大肚\");circle(\"#d91820\");\nfd(6);label(\"Longjing 龍井\");circle();\nfd(6);label(\"Shalu 沙鹿\");circle(\"#d91820\");\nfd(5);label(\"Qingshui 清水\");circle(\"#d91820\");\nfd(6);label(\"Taichung Port 臺中港\");circle();\nfd(6);label(\"Dajia 大甲\");circle(\"#d91820\");\nfd(6);label(\"Rinan 日南\");circle();\nfd(8);label(\"Yuanli 苑裡\");circle(\"#d91820\");\nfd(7);label(\"Tongxiao 通霄\");circle(\"#d91820\");\nfd(6);label(\"Xinpu 新埔\");circle();\nfd(4);label(\"Baishatun 白沙屯\");circle(\"#d91820\");\nfd(7);label(\"Longgang 龍港\");circle();\nfd(4);label(\"Houlong 後龍\");circle(\"#d91820\");\nfd(4);label(\"Dashan 大山\");circle();\nbk(77);\nrt(90);\nbk(9);\nrt(90);\n8\nlabel(\"Changhua 彰化\");circle(\"#d91820\");\n7\nHuatan 花壇\n4\nDacun 大村\n4\nlabel(\"Yuanlin 員林\");circle(\"#d91820\");\n4\nYongjing 永靖\n4\nlabel(\"Shetou 社頭\");circle(\"#d91820\");\n5\nlt(90);\npu();\ndashedLine();\nfd(30);\nlt(90);\nlabel(\"<font color='#da5530'>Changhua HSR 彰化高鐵</font>\");circle(\"#f9bd93\");\nrt(90);\npu();\nbk(30);\nrt(90);\npd();\nlabel(\"Tianzhong 田中\");circle(\"#d91820\");\n19\nlabel(\"Ershui 二水\");halfCircleBottom(\"#000000\");halfCircleTop(\"#d91820\");\nlt(90);\nfd(4);label(\"Yuanquan 源泉\");circle();\nfd(9);label(\"Zhuoshui 濁水\");circle();\nfd(7);label(\"Longquan 龍泉\");circle();\nfd(7);label(\"Jiji 集集\");circle();\nfd(11);label(\"Shuili 水里\");circle();\nfd(5);label(\"Checheng 車埕\");circle();\nbk(43);\nrt(90);\n7\nlabel(\"Linnei 林內\");circle(\"#d91820\");\n4\nShiliu 石榴\n5\nlabel(\"Douliu 斗六\");circle(\"#d91820\");\n8\nlt(90);\npu();\ndashedLine();\nfd(15);\nrt(90);\nfd(15);\nlt(90);\nfd(15);\nlt(90);\nlabel(\"<font color='#da5530'>Yunlin HSR 雲林高鐵</font>\");circle(\"#f9bd93\");\npu();\nrt(90);\nbk(15);\nrt(90);\nbk(15);\nlt(90);\nbk(15);\nrt(90);\npd();\nlabel(\"Dounan 斗南\");circle(\"#d91820\");\n4\nShigui 石龜\n5\nlabel(\"Dalin 大林\");circle(\"#d91820\");\n6\nlabel(\"Minxiong 民雄\");circle(\"#d91820\");\n5\nJiabei 嘉北\n4\nlt(90);\npu();\ndashedLine();\nfd(30);\nlt(90);\nlabel(\"<font color='#da5530'>Chiayi HSR 嘉義高鐵</font>\");circle(\"#f9bd93\");\nrt(90);\npu();\nbk(30);\nrt(90);\npd();\nlabel(\"Chiayi 嘉義\");circle(\"#d91820\");\n6\nShuishang 水上\n4\nNanjing 南靖\n6\nHoubi 後壁\n7\nlabel(\"Xinying 新營\");circle(\"#d91820\");\n4\nLiuying 柳營\n5\nLinfengying 林鳳營\n6\nlabel(\"Longtian 隆田\");circle(\"#d91820\");\n3\nBalin 拔林\n4\nlabel(\"Shanhua 善化\");circle(\"#d91820\");\n3\nNanke 南科\n4\nlabel(\"Xinshi 新市\");circle(\"#d91820\");\nfd(3);\nlt(90);\nfd(3);\nlabel(\"Yongkang 永康\");circle(\"#d91820\");\n4\nDaqiao 大橋\n4\nlabel(\"<b>Tainan 臺南</b>\");circle(\"#d91820\");\n8\nBaoan 保安\n3\nRende 仁德\n4\nlabel(\"Zhongzhou 中洲\");circle(\"#000000\");\nlt(90);\nfd(4);label(\"Chang Jung Christian University 長榮大學\");circle();\nfd(5);\nlt(90);\npu();\ndashedLine();\nfd(7);\nlt(90);\nfd(9);\ncircle();\npu();\nbk(9);\nrt(90);\nbk(7);\nrt(90);\ndashedLine();\nfd(16);\nlt(90);\nfd(19);\nlt(90);\nfd(25);\ncircle();\npu();\nbk(25);\nrt(90);\nbk(19);\nrt(90);\nbk(16);\nlabel(\"Shalun 沙崙 <font color='#da5530'>(Tainan HSR 台南高鐵)</font>\");circle(\"#f9bd93\");\nbk(9);\nrt(90);\npd();\n5\nlabel(\"Dahu 大湖\");circle(\"#d91820\");\n4\nlabel(\"Luzhu 路竹\");circle(\"#d91820\");\nfd(8);\nlabel(\"Gangshan 岡山\");\nfd(1);\ncircle(\"#d91820\");\nfd(2);\nlabel(\"<font color='#1896dc'>(Ciaotou Sugar Refinery MRT)</font>\");\nfd(3);\nlabel(\"Qiaotou 橋頭 <font color='#1896dc'>捷運</font>\");circle(\"#1896dc\");\n3\nlabel(\"Nanzi 楠梓\");circle(\"#d91820\");\n4\nlabel(\"<font color='#da5530'>(Zuoying HSR</font> <font color='#1896dc'>MRT</font><font color='#da5530'> 左營高鐵</font> <font color='#1896dc'>捷運</font><font color='#da5530'>)</font>\");\n2\nfd(1);label(\"Xinzuoying 新左營\");bk(1);thirdCircleRight(\"#f9bd93\");thirdCircleBottom(\"#1896dc\");thirdCircleLeft(\"#d91820\");\n4\nfd(1);label(\"Zuoying 左營\");bk(1);circle();\n9\nlabel(\"<b>Kaohsiung 高雄</b> <font color='#1896dc'>MRT 捷運</font>\");halfCircleTop(\"#1896dc\");halfCircleBottom(\"#d91820\");\n8\nlabel(\"Fengshan 鳳山\");circle(\"#d91820\");\n3\nHouzhuang 後庄\n5\nlabel(\"Jiuqutang 九曲堂\");circle(\"#d91820\");\n5\nLiukuaicuo 六塊厝\n4\nlabel(\"Pingtung 屏東\");circle(\"#d91820\");\n3\nGuilai 歸來\n3\nLinluo 麟洛\n3\nlabel(\"Xishi 西勢\");circle(\"#d91820\");\n4\nZhutian 竹田\n19\nlabel(\"Chaozhou 潮州\");circle(\"#d91820\");\n6\nKanding 崁頂\n6\nlabel(\"Nanzhou 南州\");circle(\"#d91820\");\n5\nZhenan 鎮安\n6\nlabel(\"Linbian 林邊\");circle(\"#d91820\");\n6\nJiadong 佳冬\n6\nDonghai 東海\n7\nlabel(\"Fangliao 枋寮\");circle(\"#d91820\");\n7\nJialu 加祿\n5\nNeishi 內獅\n6\nFangshan 枋山\n32\nGuzhuang 古莊\n5\nlabel(\"Dawu 大武\");circle(\"#d91820\");\n12\nlabel(\"Longxi 瀧溪\");circle(\"#d91820\");\nfd(7);\nlt(90);\nfd(3);\nlabel(\"Jinlun 金崙\");circle(\"#d91820\");\n12\nlabel(\"Taimali 太麻里\");circle(\"#d91820\");\n12\nlabel(\"Zhiben 知本\");circle(\"#d91820\");\n10\nlabel(\"Kangle 康樂\");circle(\"#d91820\");\n7\nlabel(\"<b>Taitung 臺東</b>\");circle(\"#d91820\");\n9\nShanli 山里\n7\nlabel(\"Luye 鹿野\");circle(\"#d91820\");\n7\nlabel(\"Ruiyuan 瑞源\");circle(\"#d91820\");\n4\nRuihe 瑞和\n8\nlabel(\"Guanshan 關山\");circle(\"#d91820\");\n9\nHaiduan 海端\n8\nlabel(\"Chishang 池上\");circle(\"#d91820\");\n8\nlabel(\"Fuli 富里\");circle(\"#d91820\");\n7\nlabel(\"Dongzhu 東竹\");circle(\"#d91820\");\n7\nlabel(\"Dongli 東里\");circle(\"#d91820\");\n8\nlabel(\"Yuli 玉里\");circle(\"#d91820\");\n11\nSanmin 三民\n14\nlabel(\"Ruisui 瑞穗\");circle(\"#d91820\");\n10\nlabel(\"Fuyuan 富源\");circle(\"#d91820\");\n4\nDafu 大富\n8\nlabel(\"Guangfu 光復\");circle(\"#d91820\");\n7\nlabel(\"Wanrong 萬榮\");circle(\"#d91820\");\n8\nlabel(\"Fenglin 鳳林\");circle(\"#d91820\");\n6\nNanping 南平\n8\nlabel(\"Fengtian 豐田\");circle(\"#d91820\");\n5\nlabel(\"Shoufeng 壽豐\");circle(\"#d91820\");\n3\nPinghe 平和\n5\nlabel(\"Zhixue 志學\");circle(\"#d91820\");\n11\nlabel(\"Jian 吉安\");circle(\"#d91820\");\n6\nlabel(\"Hualien 花蓮\");circle(\"#d91820\");\n6\nlabel(\"Beipu 北埔\");circle(\"#d91820\");\n5\nJingmei 景美\n5\nlabel(\"Xincheng 新城\");circle(\"#d91820\");\n4\nChongde 崇德\n8\nlabel(\"Heren 和仁\");circle(\"#d91820\");\n8\nlabel(\"Heping 和平\");circle(\"#d91820\");\n5\nHanben 漢本\n9\nWuta 武塔\n4\nlabel(\"Nanao 南澳\");circle(\"#d91820\");\n8\nlabel(\"Dongao 東澳\");circle(\"#d91820\");\n6\nlt(90);\nYongle 永樂\n6\nlabel(\"Suaoxin 蘇澳新\");halfCircleBottom(\"#000000\");halfCircleTop(\"#d91820\");\nlt(90);\nfd(5);label(\"Suao 蘇澳\");circle(\"#d91820\");\nbk(5);\nrt(90);\n2\ncircle();\nfd(1);\nlabel(\"Xinma 新馬\");\nfd(4);\nlabel(\"Dongshan 冬山\");circle(\"#d91820\");\n7\nlabel(\"Luodong 羅東\");circle(\"#d91820\");\n3\nZhonglǐ 中里\n2\ncircle();\nfd(1);\nlabel(\"Erjie 二結\");\nfd(5);\nlabel(\"Yilan 宜蘭\");circle(\"#d91820\");\n4\nSicheng 四城\n5\nlabel(\"Jiaoxi 礁溪\");circle(\"#d91820\");\n5\nDingpu 頂埔\n4\nlabel(\"Toucheng 頭城\");circle(\"#d91820\");\n4\nWaiao 外澳\n5\nGuishan 龜山\n5\nDaxi 大溪\n6\nDali 大里\n4\nShicheng 石城\n6\nlabel(\"Fulong 福隆\");circle(\"#d91820\");\n5\nlabel(\"Gongliao 貢寮\");circle(\"#d91820\");\n7\nlabel(\"Shuangxi 雙溪\");circle(\"#d91820\");\n5\nMudan 牡丹\n5\nlabel(\"Sandiaoling 三貂嶺\");circle(\"#000000\");\nlt(90);\nfd(8);rt(180);label(\"Dahua 大華\");circle();lt(180);\nfd(7);rt(180);label(\"Shifen 十分\");circle();lt(180);\nfd(4);rt(180);label(\"Wanggu 望古\");circle();lt(180);\nfd(5);rt(180);fd(1);label(\"Lingjiao 嶺腳\");bk(1);circle();lt(180);\nfd(3);rt(180);label(\"Pingxi 平溪\");circle();lt(180);\nfd(4);rt(180);label(\"Jingtong 菁桐\");circle();lt(180);\nbk(31);\nrt(90);\n5\nlabel(\"sHoutong 猴硐\");circle(\"#d91820\");\n7\nlt(90);\nfd(10);\npu();\nfd(1);label(\"Haikeguan\");bk(1);\nfd(5);label(\"(NMMST) 海科館\");bk(5);\npd();\ncircle();\nbk(10);\nrt(90);\nlabel(\"Ruifang 瑞芳\");circle(\"#d91820\");\n7\nSijiaoting 四腳亭\n4\nNuannuan 暖暖\n9\nlt(90);\npu();\nfd(60);\nrt(90);\nfd(50);\npd();\nrt(90);\nlabel(\"<img src=\\\"images/tra.png\\\">\");\npu();bk(155);lt(90);bk(25);rt(90);pd();\nlabel(\"<font size=96px><b>TRA Map 臺鐵地圖</b></font>\");\npu();bk(20);pd();\nlabel(\"Peter Burkimsher 林台平\");\npu();bk(5);pd();\nlabel(\"2016-10-28\");\npu();bk(8);pd();\ncircle(\"#000000\");pu();fd(1);rt(90);fd(1);lt(90);pd();label(\"Transfer station 轉乘站\");pu();rt(90);bk(1);lt(90);bk(1);\nbk(5);pd();\ncircle(\"#d91820\");pu();fd(1);rt(90);fd(1);lt(90);pd();label(\"Express 莒光\");pu();rt(90);bk(1);lt(90);bk(1);\nbk(5);pd();\ncircle(\"#f9bd93\");pu();fd(1);rt(90);fd(1);lt(90);pd();label(\"HSR 高鐵\");pu();rt(90);bk(1);lt(90);bk(1);\nbk(5);pd();\ncircle(\"#1896dc\");pu();fd(1);rt(90);fd(1);lt(90);pd();label(\"MRT 捷運\");pu();rt(90);bk(1);lt(90);bk(1);\nbk(5);rt(90);bk(7);\ndashedLine();\nfd(7);\npu();\nlt(90);\npu();fd(1);rt(90);fd(1);lt(90);pd();label(\"HSR shuttle bus 高鐵快捷公車\");pu();rt(90);bk(1);lt(90);bk(1);";
			
			jsCodeArea.value = "lt(90);\nfor (var currentStation=0;currentStation<=662;currentStation++)\n{\nvar thisStation = localStorage[\"A\"+currentStation];\n\nif (isNumeric(thisStation))\n{\nfd(thisStation);\n} else {\nif (contains(thisStation, ';'))\n{\neval(thisStation);\n} else {\nlabel(thisStation);\ncircle();\n} // end if this cell is a JS command\n} // end if this cell is a number\n} // end for every row\n";
			
			document.getElementById("numberRowsField").value = "690";
			setRows();
						
			document.getElementById("numberColumnsField").value = "20";
			setColumns();
			
			resizeDrawing("2000px", "2000px");

			//importSheet();
			cg();
			lt(90);
			for (var currentStation=1;currentStation<=699;currentStation++)
			{
				var thisStation = localStorage["A"+currentStation];
				
				if (isNumeric(thisStation))
				{
					fd(thisStation);
				} else {
					if (contains(thisStation, ';'))
					{
						eval(thisStation);
					} else {
						label(thisStation);
					circle();
					} // end if this cell is a JS command
				} // end if this cell is a number
			} // end for every row
			
			drawing.setZoom(2);
			drawing.panTo(new L.LatLng(-190, 50));

			ht();
		} // end function railway
		
		function star(numberPoints, numberDegrees, steps)
		{
			var eachAngle = numberDegrees / numberPoints;
		
			lt(numberDegrees / 2);
			rt(eachAngle / 2);
			
			for (var currentPoint = 1; currentPoint <= numberPoints; currentPoint++)
			{
				fd(steps);
				
				var thisCircle = circle();
				
				var circleText = localStorage["A" + currentPoint];
				
				thisCircle.bindPopup(circleText);
				
				objectNames[numberObjects - 1] = circleText;
				
				bk(steps);
				
				rt(eachAngle);
				
			} // end for every point
			
			//lt(numberDegrees);

			lt(numberDegrees / 2);
			lt(eachAngle / 2);

			//alert(eachAngle);
			
		} // end function star
		
		
		function starLabels(numberPoints, numberDegrees, steps)
		{
			var eachAngle = numberDegrees / numberPoints;
		
			lt(numberDegrees / 2);
			rt(eachAngle / 2);
			
			for (var currentPoint = 1; currentPoint <= numberPoints; currentPoint++)
			{
				fd(steps);
				
				var thisCircle = circle();
				
				var circleText = localStorage["A" + currentPoint];
				
				thisCircle.bindPopup(circleText);
				
				objectNames[numberObjects - 1] = circleText;
				
				
				var oldAngle = turtle.options.rotationAngle;
				var oldLatLng = turtle.getLatLng();
				
				pu();
				fd(5);

				turtle.options.rotationAngle = 0;
				labelOffset(circleText, 0);
								
				turtle.options.rotationAngle = oldAngle;
				turtle.setLatLng(oldLatLng);
							
				pd();
					
				bk(steps);
				
				rt(eachAngle);
				
			} // end for every point
			
			//lt(numberDegrees);

			lt(numberDegrees / 2);
			lt(eachAngle / 2);

			//alert(eachAngle);
			
		} // end function starLabels
		
		function branch(numberPoints, angle, steps)
		{
			//var steps = floor(5 / sinDegrees(angle));
			
			//var opposite = 5;
			//var adjacent = sinDegrees(angle);
			
			//var steps = opposite / adjacent;
			
			//steps = steps * 10;
			
			fd(steps);
			
			if (numberPoints == 1)
			{
				var thisCircle = circle();
				
				var circleText = localStorage["A1"];
				
				thisCircle.bindPopup(circleText);
				
				objectNames[numberObjects - 1] = circleText;

				return;
			}
			
			var eachAngle = 360 / numberPoints;
			
			rt(eachAngle);
			
			star(numberPoints, 360, steps / 2);
			
		} // end function branch
		
		
		function branchLabels(numberPoints, angle, steps)
		{
			fd(steps);
			
			
			var eachAngle = 360 / numberPoints;
			
			rt(eachAngle);
			
			starLabels(numberPoints, 360, steps / 2);
			
		} // end function branchLabels
		
		
		function halfBranch(numberPoints, angle, steps)
		{			
			fd(steps);
			
			var eachAngle = 180 / numberPoints;
			
			rt(eachAngle / 2);
			
			star(numberPoints, 180, steps / 4);
			
		} // end function halfBranch
		
		function isCharacter(thisCharacter)
		{
			var eightThousand = "一乙二十丁廠七蔔八人入兒匕幾九刁瞭刀力廼迺又三乾幹于虧工土士纔下寸大丈與萬上小口山巾韆乞川億個夕久麽勺凢丸及廣亾門枒椏義之屍己已巳弓子衛也女刃飛習叉馬鄉豐王開井天夫元無雲專匃匄紥紮藝木五支廳不犬太區曆歹友尤疋車鉅牙屯戈比互切瓦止少曰日中貝岡内水見午牛手氣毛壬昇陞殀長仁什片僕化讐讎幣仍僅觔爪反介父從崘崙今兇分乏公倉月氏勿欠風丹匀烏勾鳳六文亢方火爲鬥憶計訂户認宂譏心尺引醜巴孔隊辦㕥㠯允予鄧勸雙書幻玉栞未末示擊打巧正撲卉扒功扔去甘世艾古節本術可丙左厲石右佈夯戊龍平滅軋東卡北佔凸盧業舊帥歸旦目且葉甲申叮電號田由隻叭史央兄嘰叼呌敂叨另嘆冄皿凹囚四生矢失乍禾坵付仗代僊們儀白仔他斥瓜乎叢令用甩印爾樂句怱悤冊夘戼犯外處鼕鳥務包饑主市立馮玄閃蘭半汁彙頭漢寕甯穴牠討寫讓禮訓議必訊記永司尼民弗弘齣遼妳嬭奴召加皮邊孕髮聖對檯矛母幼絲邦式迂刑戎動摃寺吉釦攷託老鞏圾執擴掃地場揚耳芋共芒亞芝朽樸機權過臣吏𠕂𠕅協西壓厭戌在百有存而頁匠奪灰達列死成夾夷軌衺堯劃邁畢至此貞師塵尖劣光噹早籲吐嚇蟲麯糰吕同弔喫囙吸嗎吆嶼屹歲㠶颿迴豈則剛網肉秊硃先丢廷舌竹遷喬迄偉傳乒乓休伍伏優臼伐延仲件任傷價倫份華仰倣髣夥偽自伊血嚮佀後行舟全會殺閤兆企衆爺傘肌肋朶雜危旬旨旭負匈名多争色壯衝妝氷莊慶亦劉齊交衣次產決亥充妄閉問闖羊併並竝關米燈州汗汙汚江汛池汝湯忙興宇守宅字安講諱軍訝許訛論訟農諷設訪訣尋那迅儘導異弛孫陣陽收堦陰防姦如媍妃好她媽戱羽觀懽讙驩買紅䭾纖馴約級紀馳紉廵壽挵衖麥玖瑪形進戒吞遠違韌運扶撫罈壜技壞摳擾搤拒找批阯撦走抄貢汞壩攻赤摺抓扳掄扮搶孝埳均抑抛投墳阬抗坊抖護殼志塊扭聲把報儗㕁卻抒刦刧刼芙蕪葦芽芲蘤芹芥芬蒼芳嚴蘆芯勞尅芭囌桿槓杜材邨杖杏杉巫極李楊求甫匣更束吾荳兩酉麗醫辰勵否還尬殲來連軒步滷堅肖旱盯呈旹吴助縣裡獃吱吠嘔園曠圍呀噸足郵男睏吵串員呐聽唫吩嗆脗吹嗚吭吧邑吼囤彆吮嶇崗帳財鍼釘牡告我亂利秃秀私每兵估體何佐佑但伸佃作伯伶傭低妳住位伴身皁伺彿髴囱近徹役返餘希坐穀妥含隣岔肝疘肚肘膓龜甸免狂猶狽角刪條彤卵灸㠀鉋鑤迎飯飲繫言凍狀𤰜畂𤱈畆畮況牀庫恡療吝應這冷廬序辛棄冶忘閏閒間悶判兑竈燦灼弟汪沐沛汰瀝沙汽沃淪洶氾汎滄没溝滬瀋沉沁懷憂忱快完宋宏牢究窮災烖菑良證啟評補初社禩識詐愬罕診詞譯君靈即層屁尿尾遲侷跼改張忌際陸阿陳阻坿墜妓玅妖姉妬妒努忍勁矣雞緯驅純紗綱納駁縱紛帋紋紡驢紐奉翫環武青責現玫錶槼抹卦坷坯拓攏拔坪揀坦擔堃押抽柺拕者拍頂拆拎擁牴觝拘勢抱拄垃拉攔倖拌擰拂拙招坡披撥擇抬拇抝其取茉苦昔苛若茂蘋苗英苟苑苞範直茁茄莖苔茅枉林枝盃桮樞櫃枚析闆鬆鎗楓構杭傑述枕喪或畫卧事刺棗雨賣欝鬰礬鑛碼廁奈奔逩犇奇奮態歐毆壟妻轟頃轉斬輪輭到非叔歧肎齒些卓虎虜腎賢尚旺具味菓崐崑國哎咕昌呵暢明易嚨昂迪典固忠呻呪咋咐虖嘑謼鳴詠呢咄咖㟁嵒巗巖帖羅幟帕嶺凱敗賬販貶購貯圖釣製知迭雰垂牧物乖颳稈咊龢季委秉佳侍嶽供使例俠儌版妷姪遉侣側憑僑佩貨侈依卑的廹質訢徵徃爬彼逕所捨金刹𠇮餚斧爸採寀覓受乳貪唸貧忿膚肺肢腫脹朋股骯肪肥服脅週昬魚兎兔狐忽狗獰備飾飽飼變京亯龐店亱廟府底瘧疙疚劑䘚郊庚癈淨盲放刻育氓牐鬧鄭劵捲單炬炒炊匟炎鑪沫淺㳒灋洩沽河霑淚沮油泊沿泡註泣濘瀉泌泳泥沸沼波潑澤治怔怯怖性怕憐恠怡學寳宗定寵宜審宙官空簾宛寔試郎詩肩房誠襯衫眎眡祈諙誕詭詢該詳建肅錄隸箒屉居屆刷屈弧瀰絃承孟陋陌孤陝降圅限妹姑姐姓妮始姆迢駕叁參艱綫練組紳細駛織駒終駐絆駞紹繹經貫契貳奏旾幇幚玷珎玲⺩冊玻毒型拭𦊱掛封持拷拱項垮挎城挾撓政赴趙攩拽哉挺捪垢拴拾挑垜指墊挣擠拼挖按揮挪拯某甚荆茸革茬薦巷帶艸蠒茵茶荒茫盪榮葷熒故衚廕茘南藥標棧柑枯柄棟相査栢柵枊桺柱柹欄檸樹勃要柬鹹威歪研磚釐厚砌砂泵硯砍麪耐耍牽鷗殘殃軸輕鵶皆韮揹戰點虐臨覽豎省削甞嚐昧盹昰盼眨哇閧鬨啞顯冐暎星昨咧昭畏趴胃貴界虹蝦蟻思螞雖品嚥傌罵勳譁倃𠴰偺喒響哈哆齩欬咪哪喲炭峽罸賤貼貽骨幽鈣鈍鈔鐘鋼鈉鑰欽鈞鉤鈕卸缸拜看榘氊氫怎牲選適秒香種鞦科重複竿段便倆貸順脩俏保促俄俐侮儉俗俘信皇泉鬼侵禹侯追㑺儁盾待徊衍律很鬚敍敘劒逃食盆肧朧膽勝胞胖脈䘑衇胎勉狹獅獨狰狡獄狠貿怨急餌饒蝕餃餅巒彎將獎哀亭亮度跡蹟庭瘡瘋疫疤咨姿親音帝施閨聞閩閥閣差養美薑叛送類迷籽婁前首逆兹總鍊炸爍砲礮炫爛薙鬀窪絜洪灑柒澆濁洞測洗活派洽染洛瀏濟洋洲渾濃津恃恆恢怳恬卹䘏賉恰惱恨舉覺宣宦室宫憲突穿竊客誡冠誣語扁襖祖神祝祠誤誘誨說誦墾退既屋晝屏屎費陡遜眉孩隕除險院娃姥姨婣嬌姚娜怒架賀盈勇怠癸蚤柔壘綁毧羢結遶驕繪給絢駱絡絕絞駭統畊耘耗耙豓豔泰秦珠班素匿蠶頑盞匪撈栽捕埂捂振載趕起鹽捎扞揑埋捉綑捐損袁捌都喆逝撿挫换輓摯熱恐擣𢷬壺捅埃挨恥耿躭聶恭莽萊蓮莫莉荷穫晉噁瑩鸎真框梆桂桔棲檔桐株橋樺栓桃格樁校覈樣根索哥速逗慄賈酌配翄辱脣夏砸砰礫礎破原套逐烈殊殉顧轎較頓獘緻柴槕慮監𦂳𦃂黨逞曬眠曉哮嘮鴨㨪哺晌剔暈蚌畔蚣螡蟁蚪蚓哨哩圃哭哦恩鴦唤唁哼唧啊唉唆罷陗峩峯圓峻賊賄賂贓錢鉗鑚鉀鐵鈴鉛缺氧氨特犧造乗椉敵秤租積秧秩稱祕透筆咲筍債藉值倚俺傾倒倘俱倡候賃俛頫倍勌健臭䠶躳息倔徒徐慇艦艙般航途拏㧱挐聳爹舀愛豺豹頒頌翁胰脃脂胷肐髒臍膠腦膿逛貍狼卿逢鴕𤱊㽞畱鴛皺餓餒凌淒悽戀槳漿衰衷高郭蓆準座癥病疾齋疹疼疲脊効俲離紊唐瓷資涼站剖競部旁旅畜閱羞羔缾拳粉料益兼烤烘煩燒燭菸煙烙遞濤淛澇浦酒涉消渦浩海塗浴浮涣滌流潤澗涕浪浸漲燙澀湧誖悟悄猂悔憫悦害寬傢宵醼讌賓竅窄容宰案請朗諸諾讀扇誹韈韤袖袍被祥課𠖇㝠誰調𡨘寃諒諄談誼剥懇展劇屑弱陵祟陶陷陪娱娟恕娥孃通能難預桒絹綉驗繼駿毬瑣理瑠璢瑯捧堵措描域捺掩㨗排焉掉搥赦堆推埠掀授捻教搯掐掠掂培接擲控探據掘摻職基聆勘聊娶著蔆勒黄菲萌蘿菌萎菜萄菊菩萍菠螢營乾蕭薩菇械彬夢惏梗梧梢楳槑檢梳梯桶梭捄曹副票醞酗廂慽慼硅碩奢盔爽聾襲盛匾雪輔輛顱虚彪雀堂常眶匙晨睁瞇眼懸埜𡑀啪啦曼晦晚啄啡距趾啃躍畧蚯蛀虵唬纍鄂唱患囉唾唯啤啥嘯崖崎嶄邏崔帷崩崇崛嬰圈銬鐺鋁銅銘鏟銀矯甜稭棃犂穢迻笨籠笛笙符第敏做袋悠償偶偎媮您售停偏軀兠叚釁徘徙得銜盤舶舩舵斜盒鴿斂悉慾綵領腳𩓐脯豚臉脱象夠逸猜豬獵貓凰猖猛祭餡館湊減毫烹庻蔴菴痊癢痕廊康庸鹿盗章竟商族鏇朢率閻闡着羚蓋睠粘觕麤粒斷剪獸釺銲焕清添鴻痳涯淹渠漸淑淌混淮殽淵婬滛漁淘湻液淤淡澱㴱涮涵婆樑滲情惜慚悼懼惕惟驚惦顇惋慘慣冦𡨥寅寄寂㝛窒窯密謀諜謊諧袱禱禍謂諺謎逮敢尉屠彈隋墮隨蛋隅隆隱婚嬸婉頗頸績緒續騎綽繩維綿繃綢綜綻綠綴巢琹琳琢瓊斑替揍欵堪墖搭堰揩越趂趨超攬隄提愽揭喜彭揣揷揫蒐煑援攙裁擱搓摟攪壹握搔揉斯朞欺聯葫㪚惹塟𦵏募葛董葡敬蔥蔣蔕落韓朝辜葵棒稜棊碁椰植森焚椅椒棵棍椎棉棚椶棺榔橢惠惑偪粟棘酣酥㕑廚廈硬硝確硫鴈殖裂雄頰靂暫雅翹輩悲紫鑿輝敞棠賞掌晴睞暑冣㝡晳量鼎噴喳晶喇遇喊遏晾景疇踐跋跌跑跛遺鼃蛛蜓蜒蛤喝鵑餧餵喘喉喻嗁諠嵌幅㡌賦賭贖賜賠黑鑄鋪鏈銷鎖鋤鍋銹鋒鋅銳甥掰短智氮毯氯鵝賸稍程稀税筐等築筴筞篩筩栰答筋筝傲傅牌堡集焦傍儲暠皜皖粤奥街懲禦循艇舒踰番釋禽臈脾腋腔腕魯猩蝟猾猴憊然饋饞裝蠻就㪟斌痘痢痪痛童竣闊善翔羡普糞尊奠道遂曾燄港滯湖湘渣渤淼𣺌濕溫渴潰濺滑湃渝灣渡遊滋渲溉憤慌惰愕愣惶媿愉嘅割寒富庽竄窩窖窓𥦗牎牕窻窘徧僱裕褲帬裠禪禄謝謠謗謙犀屬屢強彊粥疎隔隙隘媒絮嫂媚壻登緬纜緝緞緩締縷騙編騷緣瑟鵡瑞瓌瑙䰟肆攝摸填搏塌皷襬㩦𢹂㩗擕搬摇搞塘攤聘斟蒜懃鞾靶鵲藍墓幙蓬蓄蒲蓉矇蒸獻椿禁楚楷欖想槐榆樓㮣賴酪酧詶醻感礙碘碑碎掽踫㼝盌椀磟尷雷〇霧雹輻輯輸督頻齡鑒睛覩睦瞄睫睡倸嗜鄙嗦愚㬉煗煖盟歇晻闇暇炤畸跨蹺跳跥跪路跤跟遣蜈蝸蛾䗬蠭蜕嗅嗡嗓署寘辠罩蜀幌錯錨錫鑼錘錐錦鍵鋸錳矮辭稺穉稠頹愁籌籤簡筷燬譭舅鼠催傻像躲魁衙微瘉癒遥膩腰腥顋腹腺鵬騰骽鮑猨蝯穎觸解煞雛饃餾醬稟痺廓癡痰㢘亷靖新韻意謄糧數煎塑慈煤煌滿漠滇源濾濫滔谿溜灕滚溢泝遡濱溶溺粱灘昚譽塞寞窺窟寢謹褂臝福謬羣殿闢障媳嫉嫌嫁疊㬪疉縛縫纏繽𠞰勦静碧琍瓈贅熬牆墟嘉摧赫截誓境摘摔撇聚慕暮摹蔓衊蔡蔗蔽藹煕𤋮蔚兢模檻榴牓搾榕謌遭酵酷釀酸碟堿鹻鹼碳磁願需轄輾雌裳顆𥄨矁墅𠻳踴蜻蠟蠅蜘蟬嘛嘀賺鍬鍛鍍舞舔穩燻箕算籮筦簫輿僚僧鼻魄魅貌膜膊髈鮮疑孵饅裹敲豪膏遮腐𤺥瘟瘦辢彰竭端旂精粹歉獘熄熔煽瀟漆潄漂漫滴漾演漏慢慷砦賽寡詧蜜寥譚肇褐褪譜隧嫰翠熊櫈騾縮慧攆撕撒撩趣趟撐撮撬播擒墪撞撤增譔聰鞵鞌蕉蕋橤蘂蔬蘊横槽櫻橡樟橄敷豌飄醋醕醉磕磊磅碾震霄黴瞞題暴瞎譆嘶嘲嘹影踢踏跴蹤蜨蝴蝠蠍蝌蝗蝙嘿囑幢墨鎮鎬鎊靠稽稻黎稾稼箱簍箭篇殭躺僻惪艘厀膛鯉鯽熟摩襃癟癅癱凛顏毅䊀鍸遵憋潛澎潮潭鯊澳潘澈瀾澂懂癄顦懊憎額翩褥譴鶴憨慰劈履豫繚撼擂𢮥撡擅鷰蕾藷薛薇擎薪薄顛翰噩櫥橙橘整螎瓢醒霍霎轍冀餐嘴踱蹏蹂蟇螃器譟鸚贈默黔鏡贊穆籃簒篷籬儒邀衡膨彫琱鵰鯨磨癮瘸凝辨辯糙餹餻燃瀕澡激懶憾懈窿壁避韁繳戴擦藉鞠藏藐檬簷檀礁粦燐霜霞瞭瞧瞬瞳矚瞪曙蹋蹈螺蟋蟀嚎贍穗魏簧簇緐幑爵朦臊鰐癌辮贏蹧粇穅燥懦豁臋臂翼驟藕鞭籐覆瞻蹦囂鐮繙飜鰭鷹瀑襟璧戳孼警蘑藻攀曝蹲蹭蹬巔簸簿蠏顫靡癬瓣羹鱉爆疆鬢壤馨燿躁蝡嚼嚷巍籍鱗魔稬穤灌譬惷覇露霹躪黯髓贛囊鑲瓤鑵矗乂乜兀弋孑孓幺亓韋廿丏卅仄戹阨仃仉仂兮刈爻卞閂訃尹夬爿毋邗邛艽艿剳劄叵帀丕匜勱卟叱叻仨仕仟仡仫仞巵氐犰芻鄺邙汀訐訌訕訖尻阡尕弁馭匡耒玎璣邢圩圬圭扦圪圳壙捫圮圯芊芍芄芨芑芎薌亙厙夼戍尥乩旯曳岌屺凼囡釔缶氘氖牝伎傴伢佤仵倀傖伉佇竚汆刖夙旮刎獷獁舛鳧鄔餳汕汔汐汲汜汊忖懺謳詎祁訥聿艮厾穽阮阪丞妁牟紆紂紇紈玕璵摶抔圻阪岅坍塢抃抉㩳芫邯蕓芾藶苣芷芮莧芼萇蓯芩芪芡芟苄苧苡杌杓杞杈忑孛邴邳磯奩豕忒歟軔迓邶忐卣鄴旰呋嘸囈呔嚦呃暘吡町虯唄吽吣吲幃岐岈峴岑嵐兕圇囫釗釙釕迕氙氚牤佞邱攸佚佝佟佗伽彷佘僉孚豸坌肟邸奂劬狄狁鳩鄒飩餼飪飫飭亨廡庋疔癤肓闈閎閔𦍑羗煬灃沅沔漚沌沏沚汩汨沂汾渢汴汶沆潙泐憮慪忡牾愾悵忻忪愴忭忸詁訶詛詆謅詔詒孜隴陀陂陘妍嫵嫗妣姙妗嬀妞姒妤邵劭剄甬邰紜紕紝綸紓瑋玡玭玠玢玥玦盂忝匭坩抨拤坫拈壚抻劼拃拊坼坻擓坨坭抿㘭耶苷苯苤蘢苫苜苴苒苘茌苻苓茚茆蔦茓塋煢茀苕櫪枇杪杳梘杵棖樅枋杻杷杼矸碭刳奄甌殁郟軛郅鳶盱昊曇杲昃咂呸昕昀旻昉炅咔畀蟣咀呷黽呱呤咚咆嚀呶呣呦噝岢巋岬岫袟袠岣峁劌逈岷剴帔嶧沓囹㒺釷釺釧釩釹釵邾迮犛氂竺迤佶佬佰侑侉臾岱侗偘侏儈佻佾儕佼佯儂帛阜侔徂劊郄慫糴罋甕戧肼膞肽肱肫剁邇郇狙狎狍狒咎炙梟餞飴冽冼庖癘疝瘍兖妾劾煒熰炖炘熗炔泔沭瀧瀘泱泅泗泠濼泖泫泮沱冺泓涇怙怵怦怛怏怍㥮怩怫懌宕穹宓誆誄詿詰戾詼戽鄆衩祆禕祉祇誅詵詬詮詣諍詫諢詡戕孢亟陔妲妯姍帑弩孥駑蝨迦迨紺紲紱駟駙縐絀驛駘甾珏琺珂瓏瑇珀頇珉珈拮埡撾垣撻垤赳賁壋垌郝垧垓撏垠茜莢荑貰蓽莒茼茴茱莛蕎茯荏荇荃薈荀茗薺茭茨堊滎犖蕁藎尅蓀茹蕒葤柰櫛柯柘櫳柩枰櫨柙枵柚枳柞柝梔柢櫟枸柈柁枷檉剌酊酈甭硨砘砒斲砭碸奎耷虺殂殤殄殆軲軻轤軼軫蠆毖覘尜哐眄瞘𠳐郢𦕈眊眈禺哂咴曷昴昱暱咦嘵嗶畎毘呲胄畋畈虼蝱盅咣噦剮鄖咻囿吚哌噲哚咯哶吒噥哏哞峙嶢罘幀峝嶠峋峥貺鈈鈦鋇鈑鈐鎢鈁鈀氡氟牯郜粃秭竽笈篤儔儼俅儷叟垡牮俣俚皈俑竢逅狥徉舢俞郗俎郤爰郛瓴腖臚胛胂胙胍胗胝朐脛鴇匍狨獪颮狩猻訇逄昝餉餄餎胤孿孌弈奕庥癧疣疥瘲庠竑彦颯闥閭闓閡羑迸秈酋炳炻熾烱烀炷烴洱洹洧洌浹洇洄洙㳄洎洫澮洮洵滸潯濜洳慟恓懨恫愷惻恂恪惲宥扃衲袵衿袂祛祜祓祚誚祗禰誥誑酖昶郡咫弭牁胥陛陟婭姮嬈姝姣姘姹懟羿炱矜絝驍驊絎絳駢耖挈珥珙頊璫珩珧珣珞琤琿敖恚埔埕塒塤堝挹耆耄埒捋贄垸捃盇荸莆蒔萵莪莠莓莜涖蒞荼莩荽蕕荻莘莎莞莨鴣蓴栲栳郴桓橈桎楨榿梃栝桕桁檜桅栟桉栩逑逋彧鬲豇酐邐厝孬砝砹礪碪砷砟砼砥砣剞礱軾輊輅鶇躉齔鸕虔逍矓嘜晟眩眙哧哽唔晁晏鴞趵趿畛蚨蚜蚍蚋蜆蠔蚧嗩圄唕唏盎唑嶗崍罡罟峪覬賅鈺鉦鈷鉢鈸鉞鉭鉬鈿鈾鉑鑠鉚鈰鉉鉈鉍鈮鈹鏺鐸氬氤氦毪舐秣秫盉笄筧笊笏笆俸倩俵偌俳俶倬倐儵恁倭倪俾倜隼雋倌倥臬皐臯郫倨衂䶊頎徠舫釜奚衾胯胱胴臙膾胼朕脒胺鴟璽鴝獧猁狳獫狺逖桀裊餑凇欒攣亳疳痾疸疽癰皰痂痙衮凋頏恣旆旄旃閫鬮誾閬恙粑朔鄲烜燁燴烊剡郯燼涑浯淶漣娑湼潿浞涓浥涔浜浠澣濬悚慳悝悒悌悛宸窈剜諏塚諑襢袢禎諉諛諗諂誶屐屙陬勐奘牂蚩陲姬娠娌娉媧娩嫻娣娓娿畚逡綆驪綃騁綏絛縚綈駸邕鷥彗耜燾舂璉琇麩揶埴埯捯擄摑埸埵赧埤捭逵埝堋堍掬鷙掖捽掊堉撣捩掮愨埭埽掇摜聃菁萁菘堇萘萋菽菖萜萸萑棻菔菟萏萃菏菹菪菅菀縈菰菡梵槤梏覡桴桷梓棁桫櫺嗇郾匱勅勑豉鄄酞酚戞硎硭硒硤磽硐硇硌鴯瓠匏廄廐龔殞殮殍賚雩輒塹眭眥嘖晡晤覜眵眸圊喏喵啉勗晞唵晗冕囀畦趺囓齧蹌蚶蛄蠣蛆蚰蠱圉蚱蛉蟶蚴啁啕唿啐唼唷啗噉啵啶啷唳唰啜幘崚崦幗崮崤崆賕賑賒銠鉺鋏鐃銦鎧鍘銖銑鋌鏵銓鎩鉿銚鉻錚銫鉸銥銃銨銣氪牾鴰穠逶箋筇笸笪笮笠笥笤笳籩笞僨偃偕偈傀傯僂皚皎鴴徜舸艫舴舷龕翎脬脘脲匐猗玀猞猝斛獼馗餜餛鸞孰庹庾痔痍疵翊旌旎袤闍閾閹閶鬩閽閼羥糲粕敝焐烯焓烽燜烷焗漬渚淇淅淞瀆涿淖挱淠涸澠淦淝淬涪淙涫渌淄愜悻悱惝惘悸惆惚㥫憚窕諶諫扈皸謔襠袷裉謁諤諭諼讒諳諦諞逯郿隈糶隍隗婧婊婕娼婢嬋胬袈翌惥慂欸綾騏綺緋緔騍緄騅綬綹綣綰驂緇耠琫琵琶琪瑛琦琥琨靚琰琮琯琬琛琚輦黿揳堞搽揸揠陻趄揖頡塄撳耋揄蛩蟄壪摒揆掾聒葑葚靰靸葳葺葸蕚葆葩葶蔞萲蕿蘐藼戟葭楮棼櫝櫂欏箠齎椋槨椪棣椐鵓覃酤酢酡鸝厥殫殛雱輥輞槧輟輜斐睄瞼睇睃戢啑嗒喃喱喹晷喈蹠跗躒跚跎跏跆蛺蟯蛭螄蛐蚘痐蛕蜖蛞蠐蛟蛘喁喟啾嗖瘖嗟嘍嗞喀喔喙嶸嵖崴遄詈嵎崽嵬嵛嵯嶁嵫幄嵋賧鋙錸鏗鋥鋰鋯鋨銼銻鋃鋦錒掣矬氰毳毽犢犄犋鵠犍嵇黍稃稂篳筵筌傣傈舄牘儻儐遑儺遯徨嬃畲弑頜翕釉鵒舜貂腈醃腓腆腴腑腚腱魷魨魴潁猢猹猥颶觴觚猱熲飱餷餿褻臠裒痣癆痦痞痤癇痧賡竦瓿啻鷳闌闃闋粞遒孳焯焜焙焱鵜湛渫湮湎湜渭湍湫溲湟溆湲湔湉渥湄滁愠惺憒惴愀愎愔嚳寐謨扉褳裎襉祾祺讜冪謖謚謐遐孱弼巽騭媪媛婷巰翬皴婺騖緙緗緘彘緹緲緦緱縋緡饗耮瑚瑁瑜瑗瑄瑕遨驁韞髡塬鄢趔趑攄摁蜇搋搪搐搛搠擯彀轂搦搡蓁戡蓍鄞靳蓐驀鶓蒽蓓蓖蓊蒯薊簑蒿蒺蘺蒟蒡蒹蒴蒗鎣頤楔枏柟楂楝檝楸椴槌楯皙櫚槎櫸楥楣楹椽裘剽甄酮酰酯酩蜃磧碓硼碉碚矴椗磣鵪輳齟齙訾粲虞睚嗪韙嗷嗉睨睢雎睥嘟嗑囁嗬嗔嗝戥嗄煦暄遢暌跬躂蹕跐跣躚躋蛸蜊蜍蜉蜣畹蛹嗣嗯嘷獋嗲噯嗌嗍嗨嗐嗤嗵罨嵊嵩嵴骰鍺錛錡鍀錁錕錮鍁錈錠錙雉氲犏歃稞粺稔筠筢筮䈰筱牒煲敫徭諐艄覦毹貊貅貉頷腠腩腼齶腧堘媵詹鮁鮃鯰鱸穌鮒鮐肄鵮颼觥遛饈鶉亶瘃疿痼痿瘐瘁瘮麂裔歆旒雝闔闐闕羧豢秔粇稉猷煳煜煨煅煊煸煺灩溱溘漭瀅溥溧溽裟溻溷潷滫溴滏滃灤溏滂滓溟澦愫懾慊鱟騫竇窠窣裱褚裨裾裰禊謾謫媾嫫媲嬡嬪媸縉縝縟轡騮縞縭縊縑騸耥璈瑶瑭獒覯慝嫠韜靉髦摽墁撂摞攖翥踅摭墉墒榖綦蔫薔靺靼鞅靿甍蔸蔟藺戬蕖蔻蓿斡鶘蓼榛榧榻榫榭槔榱槀檳櫧搉𣙜僰釅酶酹廝碡𦉆碣碲磋臧豨殯霆霽轅蜚裴翡齜齦叡瞜睽嘞嘈嘌嘁嘠曖暝躊踉蜞蜥蜮蟈蜴蜱蜩蜷蜿蜋蜢嘘嘡鶚嘣嚶嘚嗾嘧羆罱幔嶂幛賻罌骷骶鶻鍥鍇鍶鍔鍤鏘鎂鏤犒箐簀篋箍筯篛箅簞箔箜箢籙毓僖儆僳僭劁僮魃魆睾艋鄱膈臏鮭鮪鱭鮫鱘麞觫雒夤饉鑾塾麽瘌瘊瘻瘙廖韶旖膂闞鄯鯗粿粼糉糝槊鷀熘熥潢漕滹漯漶瀲潴漪漉漳漩澉濰慵搴窨寤綮譖褡褙緥褸褊譙讕譎暨屣鶥嫣嬙嫖嫦嫚嫘嫡鼐翟瞀鶩驃縹縵縲纓驄繆繅耦耬瑾璜璀瓔璁璋璿奭髥髫擷撅赭擼鋆撙攛墀聵覲韃蕙鞽蕈蕨蕤蕞蕺瞢蕃蘄賾槿檣槭樗樘樊槲醌醅靨魘饜磔磙霈轆齬齪覷瞌瞋瞑嘭噎噶顒暹噘踔踝踟踒躓踮躑踺踞蝽蠑蝻蝰蝮螋蝓蝣螻噗嘬顎噍噢噙嚕噌噔顓幞幡嶙嶝骺骼骸鑷鎘鐫鎳鎦鎰鎵鑌稷箴簣篁篌篆牖儋徵磐虢鷂臕滕鯁鱺鰱鰹鰣鯀鯇獗獠觶饊饌麾廛瘛瘼瘢瘠齏羯羰𥻗遴糌餈糅熜熵熠澍澌潸潦潲鋈潟潼潺憬憧寮窳讞襤褟褫譫熨屨嬉勰剹蝥纈繕繒驏畿耩耨耪璞璟靛璠璘聱螯髻髭髹擀熹甏擻縠磬顳蕻鞘顢薤薨檠薏藪薜薅樾橜橇樵檎櫓罇樨櫞墼橐翮醛醐醍醚磲贋飆殪霖霏蜺鏨轔臻遽氅瞟瞠矙嚄嚆噤暾蹀踹踵踽蹉蹁蟎蟒螈螅螭螠螟噱噬噫噻噼罹圜鐯鏢鏜鏝镚鏞鏑鏃鏐氌氆憇穡篝篥篦篪篙盥劓翶魎魈徼歙饍膦膙鯪鯡鯤鯧鯝鯢鯛鯔獴獺獬邂鷓廨贇瘰廪癭瘵瘴癃瘳斕麇麈嬴壅羲糗瞥甑燎燠燔燧瀨濉潞澧澹澥澶濂褰寰窸褶禧嬖犟隰嬗顙繾繰繯璨璩璐璪螫擤壕觳罄擢薹鞡鞬薷薰蘚藁檄檩懋醢瞖礅磴鷯齲齷豳壑黻嚏嚅躡蹣蹊蟥螬螵疃螳蟑嚓覊罽罾嶷黜黝髁髀鐔鐝鐐鐓鑭鑹鏹鐙罅黏簌篾篼籪簋鼢黛儡鷦鼾皤魍龠繇貘邈貔臌羴羶臆臃鱝鰈鯷鰓鰍鰉鯿螽爕鷲襄糜縻膺癍麋懣濡濮濞濠濯蹇謇邃繦檗擘孺隳嬷蟊鷸鍪鏊鰲鬈騣瞽韉鞨鞫鞧鞣蔾藠藩醪蹙礓燹餮瞿曛顥曜躇䠀鷺蟛蟪蟠蟮䴉黠黟髏髂鑊鐳鐲馥簟簮鼬讎艟鰨鰥鰩癩癔癜癖糨蹩鎏懵彝邋鬏攉攢鞲鞴藿蘧蘅麓醮醯酃霪靄霨黼嚯躕蹶蹽蹼蹵蹾躥蠖蠓蟾蠊黢髖髕鑔籀籟齁魑艨鰳鰾鱈鰻鱅麒鏖羸㸆瀚瀣瀛襦讖襞驥纘瓚攘蘩蘖醴霰酆矍曦躅鼉巉黷黥黲鑣鑞黧篹璺鼯臢鱖鱔鱒䝔貛孀驤瓘鼙醺礴顰曩鱧癲麝夔爝灝禳鐾羼蠡耱懿蘸鸛霾氍饕躐髑鑱穰饔鬻鬟趲攫攥顴躦鼴癯麐蠲蠹躞衢鑫灞襻纛鬣攮囔饢戇爨齉亍尢彳卬殳𠙶毌邘戔圢氕伋仝冮氿汈氾忉宄訏訒扞圲圫芏芃朳朸𨙸邨吒吖屼屾辿釓仳俔伈癿甪邠犴冱邡閆澫汋訢訩詝孖紃纊玒玓玘瑒剗塸壢坉扽埨坋扺撝毐芰芣苊苉芘芴芠蔿芤杕杙杄杧榪尪尨軑軏坒芈旴旵咼㕮岍㠣岠岜呇冏覎岙伾㑳伭佖伲佁颺狃閌汧汫潕湋澐沘浿汭㳇沇忮忳忺諓禡詗邲詘詖屭彄岊阽䢺阼妧妘𨚕紘馹馼紵紞駃紖玤玞瑲玟邽邿坥坰坬坽弆耵䢼𦭜茋薴苾苠枅棡枘枍矼矻匼軝暐晛旿昇昄昒昈咉咇咍岵崬岨岞峂㟃囷釴釤鍆鍚牥佴垈侁侹佸佺隹㑊侂佽侘郈舠鄶郃攽肭肸肷狉獮飿忞於炌炆泙沺泂泜泃泇怊嶨穸祋祊詷詪鄩鳲弢弨陑隑陎隮卺乸妭姈娙逕叕駓駔駉絅騶䮄紼紿砉耔㛃玶珇珅瓅珋玹珌玿韍垚墶垙塏埏垍耇垎堖垟垞挓垵垏拶荖荁薘蕘茈茽荄茺蔄荓茳𦰡茛葒㭕柷柃柊枹栐柖郚剅鳾迺厖砆砑砄耏奓龑軹軤轢軺昺睍曨盷咡咺昳昣噠昤昫昡咥昪虷虸哃峘耑峛𪨰峗峧帡鈃鈇鉅鋹釿錀鈧鈥鈄矧秬倈舁俜俙俍垕衎艤弇侴鶬䏡胠𦙶胈胩胣朏颭訄餏庤疢炣炟㶲洭洘洓洿㳚泚湞溮洸洑洢洈洚洺洨滻㳘洴洣恔宬窀扂褘祏祐祕叚陧陞娀姞姱姤姶姽枲絰駰絪駪綎綖彖驫恝珪珛珹琊玼珖勣珽珦珫珒璕珢珕珝𡑍埗垾垺埆垿埌埇莰茝䓣鄀薟莝藭莙栻椏梜桄梠栴梴栒酎酏頍砵砠砫砬硜恧翃郪輄輈輇剕貲哢晅晊嗊哳哱冔曄晐暉畖蚄蚆鄳幬崁峿輋嶮帨崀贐鉥鉕鑪鉮鉊鉧眚甡笫倻倴脩倮倕倞僤倓倧衃虒舭舯舥瓞鬯鴒脎朓胲虓魛狴峱狻眢餗勍痄疰痃竘羖羓桊敉烠烔烶烻燖涍浡浭浬涄溳涐浰浟浛浼浲涘悈悃悢礐宧窅窊窵扅扆袪袗襏祧隺堲疍𨺙陴烝砮㛚哿翀翂剟駼絺綌騂綄䂮璡珸珵琄琈琀珺掭堎堐埼掎埫堌晢墠掞埪壼㙍聹菝蘀菥莿䓫勩䓬萆菂菍菼萣罃菉䓛檮梽桲棶桯梣梌桹敔厴硔䃮磑礄硊硍勔鴷齕逴唪啫翈㫰晙畤頔趼跂蛃蚲蝀蚺嘽䎃崧崟崞崒崌崡鉶銈鉷銪鐽鋮鋣銍銱銩鐋牻牿稆笱笯偰偡鵂偭偲偁㿠鄅偓徛衒舳舲鵃悆鄃瓻貙腡脞脟䏲魢猇猊猄觖𠅤庱廎庳痓鵁竫堃閿羝羕焆烺焌淏漍淟淜淴淯湴涴璗㥄惛惔悰惙寁逭諲諴袼褌祲諟謏諝艴弸弶隤隃婞娵婼媖嫿婍婌婫婤婘婠綪綝騑騊綯綡綧驌騄絜珷琲琡琟琔琭堾堼揕㙘堧喆堨塅堠縶塿𡎚葜惎萳葙靬葴蕆蒈鄚蕢蓇萩蒐葰葎鄑蒎葖蒄萹棤棽棫椓椑櫍鵐椆棓棬棪椀楗鵏甦醱覿奡皕硪欹讋輗輬棐齗齘黹牚睎晫晪晱𧿹蛑畯斝喤崶嵁嵽崾嵅崿嶔翽顗圌圐贔淼賙䥑鐒𨧀鋱銶鋗鋝鋶鐦鋐鋟犇頲稌筀筘簹筥筅傃傉翛傒傕舾畬頫脿膕䐃腙腒頠䰾猰鵟猯㺄餶凓鄗廞廋廆鄌粢遆旐闉焞燀欻濆溚濚湝渰湓㴔渟溠渼漊湣湑溞愐愃斆甯棨扊襝祼婻媆媞㛹媓媂媄毿矞騞騠緼線騤瑃瑓瑅瑆鶄瑖瑝瑔瑀𤧛瑳瑂嶅瑑遘髢塥堽赬摛塝搒搌蒱蒨蓏蔀蓢蓂蒻蕷椹楪榃榅楒楞楩櫬椸楙歅醲碃碏碈磾硿鄠輼輶輮齠觜䣘暕鵾噁㬊暅跱蜐蜎嵲賵骱錆錤鍩鍈鑕鍃錞錇錟𨨏稑稙穇篢筻篔筶筦筤傺鵯僇艅艉谼貆腽腨腯鮋鮓鮊鮣鮈鮀鮍雊猺颸觟膢饁裛廒瘀癉鄘鶊鄜麀鄣闒闑煁煃煴煋煟煓灄溍溹滆滉溦溵漷滧滘滍愭慥慆塱襀裼禋禔禘禒譾鷫頵愍嫄媱戤勠戣騵騱縗耤瑧璊瑨瑱璦瑢斠摏墕墈墐墘摴銎𡐓墚撖𪤗靽鞁蔌蔈蓰蘞蔊嘏榰檟欓槜榍疐鶠酺釃酲酴碶䃎𥗽碨𥔲碹碥劂鮆鶪夥瞍鶡㬎跽蜾幖嶍圙鎝鍾鎪鍠鍭鍰鎄鎡鐨鎇馝鶖籜箖劄僬僦僔僎槃㙦鮚鮞鰤鮦鰂鮜鱠鮡鮠鮟夐獍飀鸑凘廑廙瘞瘥瘕鮺鄫熇漹漖瀠漤潩漼漴㽏漈漋漻慬窬窶㮾譓褕禛禚隩嫕嫭嫜嫪縯㻬表中为半包围结构璆漦靆墣墦墡劐薁蕰蔃鼒槱鷊磏磉殣憖霅暵暲暶踦踣螮蝘蝲蝤噇噂噀罶嶲嶓㠇嶟嶒鏌鎛钂鎿鎓鎔稹儇皞皛鷉艎艏鶲鮸鰷鮶鯒橥觭鶹鶺餱糈翦鷁鶼熛潖潵㵐澂瀂瑬潽潾潏憭憕鶱戭褯禤譞嫽遹驎璥璲璒憙擐鄹薳鞔黇蘋蕗薢蕹橞橑橦醑觱磡𥕢磜豶䡵齮齯鹺虤暿曌曈㬚蹅踶䗛螗疁㠓幪巘嶦鏏鐄䥕馞穄篚籛簉鼽衠盦螣縢鯖鯕鯫鯴鰺饘嚲癀瘭鷟羱糒燋熻燊燚燏濩濋澪澽澴澭澼憷憺懔黌嬛鷚翯繶璱瓛璬璮髽擿薿薸檑櫆檞醨繄磹磻瞫瞵蹐蠨㘚𨭎鏷𨭆鐇鑥鐠鏻鐏鐩鐍矰穙穜穟簕簃簏儦魋斶艚鷭谿鰆鯻鰏鰊鱨鰛鰃鰁鱂獯䗪馘襴襚鱀螱甓嬬嬥繻纁瓀釐鬹爇鞳鞮虉藟藦藨鸏檫黶礞礌𥖨蹢蹜蟫䗴嚚髃鐶鐿酇馧簠簝簰鼫鼩皦臑鰧鰟鰜鸌鸇癗𦒍旞翷囅䎖瀔瀍瀌襜鸊纆嚭㰀鬷醭蹯蠋翾鰵儳儴鼗鰶鱇䲁鰼麑麖蠃彠嬿鬒蘘欂醵顬甗𨟠巇酅髎犨鱚𨭉㸌爔瀱瀹瀼瀵襫孅驦纕耰𤫉瓖鬘趯齼罍鼱鱯鱤鱣爟爚灈韂糵蘼礵鸘躔皭龢䲘亹籥鼷鱲玃醾齇觿蠼";
			
			return contains(eightThousand, thisCharacter);
		} // end function isCharacter
		
		function drawGenealogy(thisCharacter)
		{
			loadComposition("cjk-decomp-0.4.0.txt");
			
			resizeDrawing("2000px", "2000px");
			cg();
			
			label(thisCharacter);
			
			drawAncestors(thisCharacter, 180, 10, 1);
			
			jump(0,0);
			turtle.options.rotationAngle = 0;

			rt(180);
			
			drawChildren(thisCharacter);
			
			ht();
		} // end function drawGenealogy

		function genealogy()
		{
			var thisCharacter = "高";
			
			drawGenealogy(thisCharacter);
		} // end function genealogy
		
		function drawAncestors(thisCharacter, thisAngle, maxLevel, thisLevel)
		{
			jumpName(thisCharacter);
		
			var thisParents = drawParents(thisCharacter, thisAngle);
			var thisLeft = thisParents[0];
			var thisRight = thisParents[1];
			
			if (thisLevel < maxLevel)
			{
				drawAncestors(thisLeft, thisAngle / 2, maxLevel, thisLevel + 1);
				drawAncestors(thisRight, thisAngle / 2, maxLevel, thisLevel + 1);
			} // if there are still more levels of recursion to continue

		} // end function drawAncestors
		
		
		function drawParents(thisCharacter, thisAngle)
		{
			var thisParents = new Array();
			var steps = 25;
			var numberParents = 0;
			
			thisComposition = textBetween(localStorage["compositionData"], thisCharacter + ":", ")");

			thisLeft = textBetween(thisComposition, "(", ",");
			thisRight = textBetween(thisComposition, ",", "end");
			
			if (thisLeft != "")
			{
				localStorage["A1"] = thisLeft;
				thisParents.push(thisLeft);
				numberParents = numberParents + 1;
			} // end left
			
			if (thisRight != "")
			{
				localStorage["A2"] = thisRight;	
				thisParents.push(thisRight);
				numberParents = numberParents + 1;
			} // end right
			
			star(numberParents, thisAngle, steps);
			
			if (thisLeft != "")
			{
				//if (isCharacter(thisLeft) == true)
				//{
					jumpName(thisLeft);
					turtle.options.rotationAngle = 0;
					label(thisLeft);
				//} // end if this is a character
			} // end left
			
			if (thisRight != "")
			{	
				//if (isCharacter(thisRight) == true)
				//{
					jumpName(thisRight);
					turtle.options.rotationAngle = 0;
					label(thisRight);
				//} // end if this is a character
			} // end right
			
			
			
			return thisParents;
			
		} // end function drawParents
		
		function drawChildren(thisCharacter)
		{
			
			var numberLeft = 0;
			var numberRight = 0;
			
			var leftChildren = new Array();
			var rightChildren = new Array();
			
			var steps = 25;
			
			localStorage["A1"] = "Right";
			localStorage["A2"] = "Left";

			star(2, 180, steps);
			
			compositionData = localStorage["compositionData"];
			
			var childCharacterLeftArray = compositionData.split(thisCharacter + ",");  

			for (var currentItem = 0; currentItem < childCharacterLeftArray.length; currentItem++)
			{
				var thisItem = childCharacterLeftArray[currentItem];
				
				var thisItemLines = thisItem.split(/\r?\n/);
				
				var lastLine = thisItemLines[thisItemLines.length - 1];
				
				var thisChild = textBetween(lastLine, "start", ":");
				
				leftChildren.push(thisChild);
								
				numberLeft = numberLeft + 1;
				
				localStorage["A" + numberLeft] = thisChild;
				
			} // end for every child character where startCharacter is on the left
			
			numberLeft = numberLeft - 1;
			
			jumpName("Left");
			
			var angleLeft = 360 / numberLeft;
			var sinLeft = sinDegrees(angleLeft);
			
			if (sinLeft <= 0)
			{
				sinLeft = 1;
			}
			
			subSteps = 10 / sinLeft;
						
			if (numberLeft > 0)
			{
				branchLabels(numberLeft, 360, subSteps);
			}

			jumpName("Right");


			var childCharacterRightArray = compositionData.split("," + thisCharacter);  

			for (var currentItem = 0; currentItem < childCharacterRightArray.length; currentItem++)
			{
				var thisItem = childCharacterRightArray[currentItem];
				
				var thisItemLines = thisItem.split(/\r?\n/);
				
				var lastLine = thisItemLines[thisItemLines.length - 1];
				
				var thisChild = textBetween(lastLine, "start", ":");
								
				rightChildren.push(thisChild);
				
				numberRight = numberRight + 1;
				
				localStorage["A" + numberRight] = thisChild;
				
			} // end for every child character where startCharacter is on the left

			numberRight = numberRight - 1;

			
			var angleRight = 360 / numberRight;
			
			var sinRight = sinDegrees(angleRight);
			
			if (sinRight <= 0)
			{
				sinRight = 1;
			}
			
			subSteps = 10 / sinRight;
						
			if (numberRight > 0)
			{
				branchLabels(numberRight, 360, subSteps);
			}

			
		} // end function drawChildren


		function loadComposition(filename)
		{
			var xmlhttp = new XMLHttpRequest();

			xmlhttp.onreadystatechange = function() {
				if (xmlhttp.readyState == XMLHttpRequest.DONE ) {
				   if (xmlhttp.status == 200) 
				   {
				   		localStorage["compositionData"] = xmlhttp.responseText;
				   } // end if it loaded the KML
				   else if (xmlhttp.status == 400) {
					  alert('There was an error 400');
				   }
				   else {
					   alert('something else other than 200 was returned');
				   }
				}
			};

			xmlhttp.open("GET", filename, true);
			xmlhttp.send();
				
		} // end loadComposition
		
		var QueryString = function () 
		{
			// This function is anonymous, is executed immediately and 
			// the return value is assigned to QueryString!
			var query_string = {};
			var query = window.location.search.substring(1);
			var vars = query.split("&");
			for (var i=0;i<vars.length;i++) {
			  var pair = vars[i].split("=");
				  // If first entry with this name
			  if (typeof query_string[pair[0]] === "undefined") {
				query_string[pair[0]] = decodeURIComponent(pair[1]);
				  // If second entry with this name
			  } else if (typeof query_string[pair[0]] === "string") {
				var arr = [ query_string[pair[0]],decodeURIComponent(pair[1]) ];
				query_string[pair[0]] = arr;
				  // If third or later entry with this name
			  } else {
				query_string[pair[0]].push(decodeURIComponent(pair[1]));
			  }
			} 
			return query_string;
		}();
		
		// If we have parameters
		if (QueryString.command != "")
		{
		    eval(QueryString.command);
		}
		
	</script>

	
</body>
</html>
